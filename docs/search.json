[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "ðŸŒ± Turning Data Into Nourishment ðŸŒ±",
    "section": "",
    "text": "My name is Jay Kim (she/her), a researcher passionate about food systems with a background in Psychology and East Asian studies from UC Irvine. From managing my familyâ€™s business during pandemic supply chain disruptions to supporting seniors in my community, I found a deep commitment to using data for community impact. Iâ€™ve applied analytics to reduce waste, improve efficiency, and explore climate justice research, and Iâ€™m committed to building equitable, sustainable food systems where everyone has access to what they need."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Here is where I describe what I do professionally"
  },
  {
    "objectID": "about.html#what-i-do-for-work",
    "href": "about.html#what-i-do-for-work",
    "title": "About",
    "section": "",
    "text": "Here is where I describe what I do professionally"
  },
  {
    "objectID": "about.html#what-i-do-for-fun",
    "href": "about.html#what-i-do-for-fun",
    "title": "About",
    "section": "What I do for fun",
    "text": "What I do for fun\nGive the people what they want! Something fun!"
  },
  {
    "objectID": "resources.html",
    "href": "resources.html",
    "title": "All my favorite Resources!",
    "section": "",
    "text": "This is an h1 element.\n\n\nThis is an h1 element with the title class\n\n\nThis paragraph is orange\n\n\nThis text is centered\n\n\nThis text is both centered and orange\n\n\nHereâ€™s where Iâ€™m describing something fun that I enjoy doing.\nHereâ€™s a full line\n\nHereâ€™s one line\nHereâ€™s another line\n\n\nThis is centered"
  },
  {
    "objectID": "posts.html",
    "href": "posts.html",
    "title": "Blog",
    "section": "",
    "text": "How Crop Type and Climate Zone Influence Agricultural Water Use in California\n\n\n\nMEDS\n\nR\n\n\n\n\n\n\n\n\n\n\nDec 4, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nEaton and Palisades Fires: A Satellite & Social Vulnerability Analysis\n\n\n\nMEDS\n\nPython\n\n\n\n\n\n\n\n\n\n\nDec 3, 2025\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/ep-wildfire-analysis/index.html",
    "href": "posts/ep-wildfire-analysis/index.html",
    "title": "Eaton and Palisades Fires: A Satellite & Social Vulnerability Analysis",
    "section": "",
    "text": "Github Repository: https://github.com/jwonyk/ep-wildfire-analysis"
  },
  {
    "objectID": "posts/ep-wildfire-analysis/index.html#about",
    "href": "posts/ep-wildfire-analysis/index.html#about",
    "title": "Eaton and Palisades Fires: A Satellite & Social Vulnerability Analysis",
    "section": "About",
    "text": "About\n\nPurpose\nIn early 2025, two major Southern California wildfires, the Eaton and the Palisades Fire, burned across different parts of Los Angeles County. To better understand the impacts of these events, this project combines Landsat 8 satellite imagery with census-tract-level community indicators from the 2024 Environmental Justice Index (EJI). By integrating remote sensing and social vulnerability data, this analysis highlights both the visible physical burn patterns from space and the community characteristics of affected populations.\n\n\nHighlights\n\nRestore missing CRS from a Landsat NetCDF file\nCreate true and false-color images to visualize vegetation, burned areas, and the landscape condition\nOverlay false-color imagery with the fire perimeter to illustrate aftermath of wildfire\nExamined key vulnerability indicator: age\nCompared the vulnerability profiles of communities affected by the Palisades and Eaton fires\n\n\n\nAbout the data\n\nFire Perimeter Dataset\nThe fire perimeter dataset contains dissolved burn boundaries for the Eaton and Palisades fires. The original data comes from NIFC FIRIS (Fire Integrated Real-time Intelligence System). The data provides daily fire growth during the event of wildfire. The dataset is accessed through Los Angeles GeoHub and it is also accesscible from NIFC FIRIS public ArcGIS service.\n\n\nLandsat NetCDF Dataset\nThe Landsat used in this analysis is a Landsat 8 Collection Level-2 Surface Reflectance product accessed through the Microsoft Planetary Computer Data Catalogue. The dataset includes multiple spectral bands stored in a NetCDF structure, CRS information, coordinate dimensions, and metadata. The spectral bands will assist to create true and false-color composite images for post-fire assessment.\n\n\nEnvironmental Justice Index Community Vulnerability Analysis\nThis analysis uses the 2024 Environmental Justice Index (EJI) to identify and compare census tracts affected by the Eaton and Palisades fires, using spatial joins and clipping to the fire boundaries. After aligning datasets to a shared CRS, the intersecting tracts are examined using four key vulnerability indicators, such as age, vehicle access, poverty, and overall EJI score, to highlight differences in social and demographic vulnerability between the two burn areas."
  },
  {
    "objectID": "posts/ep-wildfire-analysis/index.html#part-1---satellite-imagery-analysis",
    "href": "posts/ep-wildfire-analysis/index.html#part-1---satellite-imagery-analysis",
    "title": "Eaton and Palisades Fires: A Satellite & Social Vulnerability Analysis",
    "section": "Part 1 - Satellite Imagery Analysis",
    "text": "Part 1 - Satellite Imagery Analysis\n\nSetup for the Analysis\n\n# Import packages for this project\nimport os\nimport numpy as np\nimport pandas as pd\nimport geopandas as gpd\nimport xarray as xr\nimport rioxarray\nimport matplotlib.pyplot as plt\nimport matplotlib.patches as mpatches\n\n\n# Set pandas to display all columns\npd.set_option(\"display.max_columns\", None)\n\n\n# Load fire perimeter datasets\neaton = gpd.read_file(os.path.join('data',\n                                      'fire_perimeters',\n                                      'Eaton_Perimeter_20250121.geojson'))\n\npalisades = gpd.read_file(os.path.join('data',\n                                      'fire_perimeters',\n                                      'Palisades_Perimeter_20250121.geojson'))\n\n\n# Import NetCDF dataset\nlandsat = xr.open_dataset(\"data/landsat8-2025-02-23-palisades-eaton.nc\")\n\n\n\nRestore Geospatial Information (CRS Recovery)\nThe NetCDF file contains projection information inside the spatial_ref variable. rio.crs initially shows that no CRS is assigned. I will extract the WKT projection from spatial_ref.crs_wkt and write it back to the dataset using rio.write_crs().\n\n# extract CRS from the spatial_ref variable\ncrs_wkt = landsat.spatial_ref.crs_wkt\n\n# write CRS into rioxarray metadata\nlandsat = landsat.rio.write_crs(crs_wkt)\n\n\n\nTrue-Color Composite\nI will select the red, green, and blue bands and converted them into a 3-band array. The initial plot produces warnings due to bright cloud outliers, so I will use the robust = True parameter to ignore extreme values. At the end, I will identify and replace NaN values to create a clean final RGB image.\n\nrgb = landsat[['red', 'green', 'blue']].fillna(0)\n\nrgb_plot = (rgb.to_array().plot.imshow(\n    robust = True, \n    figsize = (7, 7), \n    add_colorbar = False))\n\nplt.title(\"True Color Composite (Landsat 8, Feb 23 2025)\", fontsize = 14)\nplt.axis(\"off\")\nplt.tight_layout()\n\n\n\n\n\n\n\n\n\n\nFalse-Color Composite\nFalse color composites help highlight vegetation health and burn severity. I will plot a SWIR2, NIR, Red composite without creating new variables.\n\n(landsat[['swir22', 'nir08', 'red']].fillna(0)\n                                  .to_array()\n                                  .plot.imshow(\n                                    robust = True, \n                                    figsize = (7,7),\n                                    add_colorbar = False))\n\nplt.title(\"False Color Composite (Landsat 8, Feb 23 2025)\", fontsize = 14)\nplt.axis(\"off\")\nplt.tight_layout()\n\n\n\n\n\n\n\n\n\n\nOverlaying Fire perimeters\n\n# Create a figure and axes for plotting\nfig, ax = plt.subplots(figsize = (10, 10))\n\n# ---------------------------------------------------------------\n# BASE LAYER\n# ---------------------------------------------------------------\n\n# Plot the false color landsat composite (SWIR2, NIR, Red)\n(landsat[['swir22', 'nir08', 'red']].fillna(0)\n                                    .to_array()\n                                    .plot.imshow(ax = ax,\n                                    add_colorbar = False,\n                                    robust = True))\n\n# ---------------------------------------------------------------\n# FIRE PERIMETER OVERLAYS\n# ---------------------------------------------------------------\n\n# Plot Eaton Fire perimeter using the raster's CRS\neaton.to_crs(landsat.rio.crs).plot(ax = ax,\n                                   edgecolor = 'yellow',\n                                   facecolor = 'none',\n                                   linewidth = 1.5)\n\n# Plot Palisades Fire perimeter using the raster's CRS\npalisades.to_crs(landsat.rio.crs).plot(ax = ax,\n                                   edgecolor = 'red',\n                                   facecolor = 'none',\n                                   linewidth = 1.5)\n\n# ---------------------------------------------------------------\n# CUSTOM LEGEND PATCHES\n# ---------------------------------------------------------------\n\n# Create a custom label bubble for Eaton\neaton_patch = mpatches.Patch(facecolor = 'none',\n                             edgecolor = 'yellow',\n                             linewidth = 2.5,\n                             label = 'Eaton Fire')\n\n# Create a custom label bubble for Palisades\npalisades_patch = mpatches.Patch(facecolor = 'none',\n                             edgecolor = 'red',\n                             linewidth = 2.5,\n                             label = 'Palisades Fire')\n\n# Display a legend identifying each fire perimeter\nax.legend(handles = [eaton_patch, palisades_patch],\n          loc = 'upper left')\n\n# ---------------------------------------------------------------\n# ON-MAP TEXT LABELS\n# ---------------------------------------------------------------\n\n# Eaton label (top right)\nax.text(0.75, 0.80,\n        'Eaton Fire',\n        transform = ax.transAxes,\n        fontsize = 12,\n        color = 'yellow',\n        fontweight = 'bold',\n        bbox = dict(boxstyle = 'round',\n                    facecolor = 'black',\n                    alpha = 0.5))\n\n# Palisades label (bottom left)\nax.text(0.15, 0.20,\n        'Palisades Fire',\n        transform = ax.transAxes,\n        fontsize = 12,\n        color = 'red',\n        fontweight = 'bold',\n        bbox = dict(boxstyle = 'round',\n                    facecolor = 'white',\n                    alpha = 0.75))\n\n# ---------------------------------------------------------------\n# TITLE AND LAYOUT\n# ---------------------------------------------------------------\n\n# Label the map to clarify the image and overlays\nax.set_title((\"False Color Landsat (Feb 23, 2025) \",\n             \"with Fire Perimeters (Jan 21, 2025)\"),\n             fontsize = 13)\n\n# Remove both axis ticks\nax.set_xticks([])\nax.set_yticks([])\n\n# Replace x and y label\nax.set_xlabel(\"Easting (meters)\", fontsize = 12)\nax.set_ylabel(\"Northing (meters)\", fontsize = 12)\n\n# Improve layout so elements do not overlap\nplt.tight_layout()\n\n\n\n\n\n\n\n\n\n\nFigure Description\nThis map shows a false color Landsat composite with SWIR2, NIR, Red bands over the perimeters for both Eaton and Palisade fires. In this false color image, shortwave infrared (SWIR2) and near-infraed(NIR) energy responses highlight differences between healthy vegetation, burned, and developed areas. Burned area appear in different color compare to healthy vegetation areas are bright green. Overlaying the fire perimeter boundaries on top of the images shows the visual comparison of burn patterns."
  },
  {
    "objectID": "posts/ep-wildfire-analysis/index.html#part-2---social-vulnerability",
    "href": "posts/ep-wildfire-analysis/index.html#part-2---social-vulnerability",
    "title": "Eaton and Palisades Fires: A Satellite & Social Vulnerability Analysis",
    "section": "Part 2 - Social Vulnerability",
    "text": "Part 2 - Social Vulnerability\nThe 2024 Environmental Justice Index (EJI) dataset examined community characteristics in the census tracts that intersected each fire. All data were converted to a shared CRS and spatially joined to the fire perimeters using geopandas.sjoin().\nTo focus on social and demographic factors relevant to wildfire response, following indicator was selected: - E_AGE65: Percent population aged 65+\n\nSetup for the Analysis\n\n# Import library that is necessary for this analysis\nimport contextily as ctx\n\n# EJI data (geodatabase)\neji = gpd.read_file(\"data/EJI_2024_California/EJI_2024_California.gdb\")\n\n# Reproject\neji = eji.to_crs(epsg = 4326)\n\n\n\nSpatial Join - Identify Census Tract intersecting Each Fire\nTo determine which communities were affected, I performed a spatial join between the EJI census tracts and each fire perimeter. This identifies all tracts whose boundaries intersect the Eaton or Palisades fire footprint.\n\n# Spatial join\ncensus_within_palisades = gpd.sjoin(eji, palisades, how = \"inner\", predicate = \"intersects\")\ncensus_within_eaton = gpd.sjoin(eji, eaton, how = \"inner\", predicate = \"intersects\")\n\n# Check how many tracts there is\nprint(\"Palisades tracts:\", len(census_within_palisades))\nprint(\"Eaton tracts:\", len(census_within_eaton))\n\nPalisades tracts: 36\nEaton tracts: 38\n\n\n\n\nPolygon Clipping\nTo focus only on the census-tract areas actually affected by each fire, I clipped the EJI tracts to the Eaton and Palisades fire boundaries. This trims the polygons to the exact burned footprint and ensures the demographic analysis reflects only the portions of each tract that were inside the fire perimeter.\n\n# Clip EJI census tracts to each fire perimeter\npalisades_clipped = gpd.clip(census_within_palisades, palisades)\neaton_clipped = gpd.clip(census_within_eaton, eaton)\n\n\n\nPlot Age 65+ for Both Fire Areas\nAfter clipping the census tracts to each fire boundary, I mapped the percentage of residents aged 65 and older using a shared color range. This visualization illustrates how the elderly population is distributed within each burn area and highlights differences between the communities affected by the two fires.\n\n# Assign name for the EJI column name\neji_variable = 'E_AGE65'\n\n# Find common min/max for legend range\nvmin = min(census_within_palisades[eji_variable].min(), \n           census_within_eaton[eji_variable].min())\n\nvmax = max(census_within_palisades[eji_variable].max(), \n           census_within_eaton[eji_variable].max())\n\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize = (7, 7))\n\n# Plot census tracts within Palisades perimeter\ncensus_within_palisades.plot(\n    column = eji_variable,\n    vmin = vmin, vmax = vmax,\n    legend = False,\n    ax = ax1)\nax1.set_title('Palisades Fire Area', fontsize = 25)\nax1.axis('off')\n\n# Plot census tracts within Eaton perimeter\ncensus_within_eaton.plot(\n    column = eji_variable,\n    vmin = vmin, vmax = vmax,\n    legend = False,\n    ax = ax2)\nax2.set_title('Eaton Fire Area', fontsize = 25)\nax2.axis('off')\n\n# Add overall title\nfig.suptitle('Age 65+ - Fire Areas Comparison', fontsize = 45)\n\n# Add shared colorbar at the bottom\nsm = plt.cm.ScalarMappable(norm = plt.Normalize(vmin = vmin, vmax = vmax))\ncbar_ax = fig.add_axes([0.25, 0.08, 0.5, 0.02])  # [left, bottom, width, height]\ncbar = fig.colorbar(sm, cax = cbar_ax, orientation = 'horizontal')\ncbar.set_label('Population Age Over 65')\n\nplt.show()\n\n\n\n\n\n\n\n\n\n\nFigure Description\nClipping the EJI census tracts to each fire boundary refines the analysis by showing only the precise areas affected by the Eaton and Palisades fires. When mapped, the clipped tracts reveal that each fire intersects a different set of communities. Using the Age 65+ indicator, the Palisades area generally shows a higher proportion of older adults, while the Eaton area displays lower but more variable elderly populations. This difference highlights how the fires impacted communities with distinct demographic vulnerabilities."
  },
  {
    "objectID": "posts/ep-wildfire-analysis/index.html#reference",
    "href": "posts/ep-wildfire-analysis/index.html#reference",
    "title": "Eaton and Palisades Fires: A Satellite & Social Vulnerability Analysis",
    "section": "Reference",
    "text": "Reference\n\nLos Angeles GeoHub / NIFC FIRIS. (2025). Palisadesâ€“Eaton dissolved fire perimeters [data file]. Available: https://geohub.lacity.org/maps/ad51845ea5fb4eb483bc2a7c38b2370c/about. [Accessed: Nov.Â 15, 2025]\nU.S. Geological Survey. Landsat Collection 2 Level-2 Surface Reflectance (Microsoft Planetary Computer version) [data file]. Available: https://planetarycomputer.microsoft.com/dataset/landsat-c2-l2. [Accessed: Nov.Â 15, 2025]\nU.S. Department of Health and Human Services. (2024). Environmental Justice Index (EJI), 2024 â€“ California Census Tract Data [data file]. Available: https://www.atsdr.cdc.gov/place-health/php/eji/eji-data-download.html. [Accessed: Nov.Â 21, 2025]"
  },
  {
    "objectID": "posts/crop-water-gamma/index.html",
    "href": "posts/crop-water-gamma/index.html",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "",
    "text": "Github Repository: https://github.com/jwonyk/crop-water-gamma"
  },
  {
    "objectID": "posts/crop-water-gamma/index.html#about",
    "href": "posts/crop-water-gamma/index.html#about",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "About",
    "text": "About\n\nDataset Description\nCalifornia produces a large portion of the nationâ€™s fruits, nuts, and vegetables. Irrigated agriculture dominates water use in the state, and the amount of water applied varies by crop type, hydrologic region, and year.1\nThis dataset provides annual estimates of:\n\nApplied Water per Acre\nHydrologic Regions\n20 Crop Categories\nYears 2016 - 2020\n\nIn this blog post, we would like to dive in to understand how climate region, crop type, and year would influence our Gamma response variable, applied water per acre.\n\n\nData Access\nCalifornia Department of Water Sources - Statewide Agricultural Land & Water Use (2016 -2020)"
  },
  {
    "objectID": "posts/crop-water-gamma/index.html#clear-the-environment-and-load-libraries",
    "href": "posts/crop-water-gamma/index.html#clear-the-environment-and-load-libraries",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "Clear the Environment and Load Libraries",
    "text": "Clear the Environment and Load Libraries\n\n# Clear the environment\nrm(list = ls())\n\n# Load in libraries\npacman::p_load(tidyverse, dplyr, here, readxl, pals, broom, knitr,\n               janitor, dagitty, ggdag, ggplot2, kableExtra)"
  },
  {
    "objectID": "posts/crop-water-gamma/index.html#load-and-explore-data",
    "href": "posts/crop-water-gamma/index.html#load-and-explore-data",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "Load and Explore Data",
    "text": "Load and Explore Data\nIn this section, we load the raw Excel file and prepare it for analysis. Real datasets often contain unnecessary columns, inconsistent variable names, or values that must be converted into usable formats. We use functions like clean_names(), select(), and pivot_longer() to transform the data into a tidy structure, where each row corresponds to a single crop-year-region combination. Finally, we filter out missing or zero values so the Gamma model, which requires positive continuous outcomes, can be correctly fit.\n\n# Read in data and clean the name to snake case and drop unused columns\nwater_raw &lt;- read_excel(here(\"posts\", \"crop-water-gamma\", \"data\",\n                  \"agricultural_water_use_data_2016_2020.xlsx\"),\n             sheet = \"Statewide_AW_Unit\", skip = 1) %&gt;% \n  clean_names() %&gt;% \n  select(!starts_with(\"x\"))\n\n# Pivot all crop columns, convert variable types, and drop missing rows\nwater_long &lt;- water_raw %&gt;% \n  pivot_longer(cols = -c(year, hr),\n               names_to = \"crop\",\n               values_to = \"aw_per_acre\") %&gt;% \n  mutate(aw_per_acre = as.numeric(aw_per_acre),\n         year = as.integer(year),\n         hr = as.factor(hr),\n         crop = as.factor(crop)) %&gt;% \n  filter(!is.na(aw_per_acre),\n         aw_per_acre &gt; 0)"
  },
  {
    "objectID": "posts/crop-water-gamma/index.html#exploratory-visualization",
    "href": "posts/crop-water-gamma/index.html#exploratory-visualization",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "Exploratory Visualization",
    "text": "Exploratory Visualization\nBefore fitting any statistical model, it is essential to understand the distribution of the variables. The violin plot visualizes how applied water per acre varies across crop types and reveals skewness, outliers, and general patterns. This helps justify the modeling choices and provides intuition about which predictors might influence water use.\n\n# Create a consistent color palette for crop types\ncrop_cols &lt;- setNames(alphabet()[1:length(levels(water_long$crop))], \n                      levels(water_long$crop))\n\nwater_long %&gt;%\nggplot(aes(x = crop, y = aw_per_acre, fill = crop)) +\n  geom_violin(trim = FALSE, alpha = 0.7) +\n  geom_boxplot(width = 0.1, outlier.shape = NA, alpha = 0.5) +\n  scale_fill_manual(values = crop_cols) +\n  coord_flip() +\n  theme_bw() +\n  theme(legend.position = \"none\",\n        plot.title = element_text(size = 14, face = \"bold\", hjust = 0),\n        axis.title.y = element_blank()) +\n  labs(y = \"Applied Water per Acre\")\n\n\n\n\nDistribution of applied water per acre across crop types, using violin + boxplot to visualize skewness and variability."
  },
  {
    "objectID": "posts/crop-water-gamma/index.html#dag-directed-acyclic-graph",
    "href": "posts/crop-water-gamma/index.html#dag-directed-acyclic-graph",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "DAG (Directed Acyclic Graph)",
    "text": "DAG (Directed Acyclic Graph)\nA Directed Acyclic Graph clarifies our assumptions about how variables influence each other. Letâ€™s dive into our variables:\n\nCrop Types influence water use because different crops require different irrigation levels\nThe hydrologic region affects crop type because different regions have different crops\nBoth year and hydrologic influence applied water per acre due to climate and resource availability\n\nThese relationships reflect scientific justification, including crop, hydrological region, and predictors in the regression model.\n\n\nCode\n# Draw a DAG\nwater_dag &lt;- dagitty(\"dag {\n               hr -&gt; crop\n               hr -&gt; aw_per_acre\n               year -&gt; crop\n               year -&gt; aw_per_acre\n               crop -&gt; aw_per_acre}\")\n\n# Assign coordinate for each variable nodes\ncoordinates(water_dag) &lt;- list(\n  x = c(hr = 0, year = 2, crop = 1, aw_per_acre = 3),\n  y = c(hr = 2, year = 2, crop = 1, aw_per_acre = 1))\n\n# Assign color for the nodes\nnode_colors &lt;- c(hr = \"#7F95D1\", year = \"#FF82A9\", \n                 crop = \"#FA824C\", aw_per_acre = \"#1B998B\")\n\n# Plot DAG\nggdag(water_dag, text = FALSE, node = FALSE) +\n  geom_dag_node(aes(fill = name), size = 12, shape = 21, color = \"white\") +\n  geom_dag_edges() +\n  scale_fill_manual(values = node_colors, name = \"Variables\",\n                    labels = c(aw_per_acre = \"Applied Water per Acre\",\n                               crop = \"Crop Type\",\n                               hr = \"Hydrologic Region\",\n                               year = \"Year\")) +\n  theme_minimal() +\n  theme(legend.title = element_text(size = 15, face = \"bold\", hjust = 0.5),\n        legend.position = \"right\",\n        legend.text = element_text(size = 12, face = \"bold\"),\n        axis.title = element_blank(),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid = element_blank(),\n        panel.background = element_blank(),\n        plot.margin = margin(10, 10, 10, 10))\n\n\n\n\n\nDAG representing hypothesized causal relationships among crop type, hydrologic region, year, and applied water per acre.\n\n\n\n\nThe DAG summarizes our assumptions about how crop type, hydrologic region, and year influence applied water per acre. Hydrologic region influences crop type because certain crops grow better in specific climates and soils. Both hydrologic region and year influences the response variable due to variation in precipitation, groundwater availability, and climate condition. Year affects crop distribution annually as they response directly to the market and climate."
  },
  {
    "objectID": "posts/crop-water-gamma/index.html#statistical-modeling",
    "href": "posts/crop-water-gamma/index.html#statistical-modeling",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "Statistical Modeling",
    "text": "Statistical Modeling\n\nWhy Gamma?\nThe Gamma Distribution with a log link works best with this data because the applied water per acre is positive and continuous. A positive continuous variable is a numerical value that can take any real number that is greater than zero.\nThe distribution is right-skewed, meaning most values are small, and a few very extreme values stretch the tail to the right, causing the data to cluster near the lower end and occasional extreme values that create an asymmetrical shape with a long right tail. Also, because it can only be positive.\nA multiplicative effect shows scientific results that change the outcome in proportion to the change. Rather than adding or subtracting a fixed amount, we can view the numbers as a percentage difference or twice as large. Multiplying the response is more meaningful than adding a constant amount, which makes the Gamma model fit right in.\n\n\nGamma Model in Statistical Notation\nThe mathematical form of the model explains this notation:\n\\[\n{Applied~Water} \\sim Gamma(\\mu, \\phi) \\\\\\\\\nlog(\\mu) = \\beta_0 + \\beta_1 * (Crop) + \\beta_2 * (Hydrologic~Region) + \\beta_3 *(Year)\n\\] The linear predictor for the mean is on the log scale, and the parameter of Gamma consists of the following:\n\n\\(\\mu\\) is expected applied water per acre\n\\(\\phi\\) is shape parameter and it controls with its size.\n\nLarger \\(\\phi\\) - distribution becomes more symmetric\nSmaller \\(\\phi\\) - distribution becomes more right-skewed and more spread out\n\n\n\n\nFit Model to Simulated Data\nTo demonstrate how the Gamma model works under the known parameters, we simulated 200 observations from a Gamma distribution with a log-linear mean structure. We set the \\(\\beta_0 = 1\\) and a slope \\(\\beta_1 = -0.4\\).\n\n# Initialize simulated random data\nset.seed(123)\nn &lt;- 200 # Sample Size\nbeta0 &lt;- 1 # Intercept\nbeta1 &lt;- -0.4 # Slope, controls strength and direction\nphi &lt;- 4 # Gamma Shape\n\n# Simulated a positive and right-skewed predictor\npredictor &lt;- rgamma(n, shape = 2, scale = 1)\n\n# Simulated Gamma-distribute response with mean\nresponse &lt;- rgamma(n, shape = phi, \n                   scale = exp(beta0 + beta1 * predictor) / phi) \n\nsim_data &lt;- tibble(predictor, response)\n\nsim_model &lt;- glm(response ~ predictor,\n                 data = sim_data,\n                 family = Gamma(link = \"log\"))\n\nsim_results &lt;- tidy(sim_model, conf.int = TRUE)\n\nsim_results %&gt;%\n  kbl(digits = 3, \n      caption = \"Gamma Regression Coefficients from Simulated Data (with 95% CI)\",\n      col.names = c(\"Term\", \"Estimate\", \"Std. Error\",\n                    \"Statistic\", \"p-value\",\n                    \"CI Lower\", \"CI Upper\")) %&gt;%\nkable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"),\n              full_width = FALSE, position = \"center\") %&gt;%\n  row_spec(0, bold = TRUE, background = \"#f0f0f0\")\n\n\nGamma Regression Coefficients from Simulated Data (with 95% CI)\n\n\nTerm\nEstimate\nStd. Error\nStatistic\np-value\nCI Lower\nCI Upper\n\n\n\n\n(Intercept)\n1.039\n0.063\n16.485\n0\n0.913\n1.167\n\n\npredictor\n-0.435\n0.028\n-15.321\n0\n-0.491\n-0.376\n\n\n\n\n\n\n\nParameter Recovery for Simulated Data\nDuring the simulation, the true parameters were:\n\nIntercepts: \\(\\beta_0 = 1\\)\nSlope: \\(\\beta_1 = -0.4\\)\n\nThe fitted Gamma regression model estimated coefficients very close to the true values we selected. The intercept estimate is approximately 1, and the slope estimate is approximately -0.4, indicating that the Gamma model with a log link successfully recovers the underlying parameters when the model assumptions hold. The simulation validates that the Gamma model applies to the water data.\n\n# Plot the simulated data\nggplot(sim_data, aes(predictor, response)) +\n  geom_point(alpha = 0.75) +\n  labs(x = \"Predictor\", y = \"Response\") +\n  theme(plot.title = element_text(size = 14, face = \"bold\", hjust = 0.5))\n\n\n\n\nSimulated Gamma-distributed response data with a log-linear relationship.\n\n\n\n\n\nggplot(sim_data, aes(x = predictor, y = response)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"glm\",\n              method.args = list(family = Gamma(link = \"log\")),\n              se = TRUE, color = \"red\", fill = \"lightblue\", size = 1.1) +\n  theme_bw() +\n  labs(x = \"Predictor\", y = \"Response\")\n\n\n\n\nSimulated Data with Fitted Gamma Regression Line"
  },
  {
    "objectID": "posts/crop-water-gamma/index.html#fit-to-real-life-data",
    "href": "posts/crop-water-gamma/index.html#fit-to-real-life-data",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "Fit to Real Life Data",
    "text": "Fit to Real Life Data\n\n\nCode\n# Fit Gamma Regression using log link to model applied water per acre\nwater_gamma_model &lt;- glm(aw_per_acre ~ crop + hr + year,\n           family = Gamma(link = \"log\"),\n           data = water_long)\n\n# Make the table presentable\nwater_results &lt;- tidy(water_gamma_model, conf.int = TRUE) %&gt;%\n  mutate(term = gsub(\"crop\", \"Crop: \", term),\n         term = gsub(\"hr\", \"Region: \", term)) %&gt;%\n  kable(format = \"html\",\n        caption = \"Gamma Regression Coefficients with 95% Confidence Intervals\",\n        col.names = c(\"Term\", \"Estimate\", \"Std. Error\", \"Statistic\", \"p-value\",\n                      \"CI (Lower)\", \"CI (Upper)\"), digits = 3) %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"),\n                full_width = FALSE, position = \"center\") %&gt;%\n  row_spec(0, bold = TRUE, background = \"#f0f0f0\")\n\n# Show table\nwater_results\n\n\n\nGamma Regression Coefficients with 95% Confidence Intervals\n\n\nTerm\nEstimate\nStd. Error\nStatistic\np-value\nCI (Lower)\nCI (Upper)\n\n\n\n\n(Intercept)\n31.163\n10.521\n2.962\n0.003\n10.738\n51.587\n\n\nCrop: almonds_pistachios\n-0.089\n0.044\n-2.011\n0.045\n-0.174\n-0.002\n\n\nCrop: avg_aw\n-0.337\n0.042\n-8.121\n0.000\n-0.419\n-0.256\n\n\nCrop: citrus_subtropical\n-0.185\n0.043\n-4.321\n0.000\n-0.268\n-0.101\n\n\nCrop: corn\n-0.420\n0.042\n-9.949\n0.000\n-0.502\n-0.337\n\n\nCrop: cotton\n-0.134\n0.053\n-2.511\n0.012\n-0.237\n-0.029\n\n\nCrop: cucurbits\n-0.687\n0.043\n-16.039\n0.000\n-0.771\n-0.603\n\n\nCrop: dry_beans\n-0.677\n0.046\n-14.880\n0.000\n-0.766\n-0.588\n\n\nCrop: grain\n-1.384\n0.042\n-33.322\n0.000\n-1.466\n-1.303\n\n\nCrop: onions_garlic\n-0.663\n0.043\n-15.367\n0.000\n-0.748\n-0.579\n\n\nCrop: other_deciduous\n-0.232\n0.042\n-5.524\n0.000\n-0.314\n-0.149\n\n\nCrop: other_field_Crop: s\n-0.240\n0.042\n-5.688\n0.000\n-0.322\n-0.157\n\n\nCrop: pasture\n0.102\n0.042\n2.463\n0.014\n0.021\n0.184\n\n\nCrop: potatoes\n-0.147\n0.045\n-3.280\n0.001\n-0.235\n-0.059\n\n\nCrop: rice\n0.084\n0.058\n1.454\n0.146\n-0.029\n0.199\n\n\nCrop: safflower\n-0.582\n0.047\n-12.367\n0.000\n-0.674\n-0.489\n\n\nCrop: sugar_beets\n-0.205\n0.158\n-1.301\n0.194\n-0.501\n0.119\n\n\nCrop: tomato_fresh\n-0.585\n0.114\n-5.140\n0.000\n-0.801\n-0.355\n\n\nCrop: tomato_processing\n-0.460\n0.045\n-10.110\n0.000\n-0.549\n-0.371\n\n\nCrop: truck_Crop: s\n-0.767\n0.042\n-18.462\n0.000\n-0.849\n-0.685\n\n\nCrop: vineyard\n-0.294\n0.043\n-6.895\n0.000\n-0.378\n-0.211\n\n\nRegion: 02_San Francisco Bay\n0.007\n0.037\n0.181\n0.856\n-0.066\n0.080\n\n\nRegion: 03_Central Coast\n0.038\n0.036\n1.062\n0.289\n-0.033\n0.109\n\n\nRegion: 04_South Coast\n0.238\n0.036\n6.528\n0.000\n0.166\n0.309\n\n\nRegion: 05_Sacramento River\n0.184\n0.036\n5.189\n0.000\n0.115\n0.254\n\n\nRegion: 06_San Joaquin River\n0.203\n0.035\n5.737\n0.000\n0.134\n0.273\n\n\nRegion: 07_Tulare Lake\n0.202\n0.036\n5.635\n0.000\n0.131\n0.272\n\n\nRegion: 08_North Lahontan\n0.120\n0.044\n2.728\n0.007\n0.034\n0.206\n\n\nRegion: 09_South Lahontan\n0.561\n0.038\n14.857\n0.000\n0.487\n0.635\n\n\nRegion: 10_Colorado River\n0.578\n0.036\n16.115\n0.000\n0.508\n0.648\n\n\nRegion: State\n0.243\n0.035\n6.869\n0.000\n0.173\n0.312\n\n\nyear\n-0.015\n0.005\n-2.847\n0.005\n-0.025\n-0.005\n\n\n\n\n\n\nCoefficient Plot\n\ntidy(water_gamma_model, conf.int = TRUE) %&gt;%\n  filter(grepl(\"^hr\", term)) %&gt;%\n  mutate(term = gsub(\"hr\", \"Region \", term), \n         term = reorder(term, estimate)) %&gt;%\n  ggplot(aes(x = term, y = estimate)) +\n  geom_point(size = 2) +\n  geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.15) +\n  coord_flip() +\n  theme_bw() +\n  labs(x = \"Hydrologic Region\", y = \"Estimate (log scale)\")\n\n\n\n\nHydrologic Region Effects with fitted Gamma regression line and 95% confidence interval"
  },
  {
    "objectID": "posts/crop-water-gamma/index.html#inference",
    "href": "posts/crop-water-gamma/index.html#inference",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "Inference",
    "text": "Inference\nWe are interested in if hydrologic region is associated with differences in applied water per acre, after adding all consideration for crop types and year.\n\nExplain Hypothesis in Plain-Language\nSome hydrologic regions require more applied water per acre than others, even after adjusting for crop type and year.\n\n\nHypothesis\n\\[\nH_0: \\beta_r = 0 \\quad \\text{(no difference in expected water use)} \\\\\nH_A: \\beta_r \\neq 0 \\quad \\text{(a region differs from the baseline region)}\n\\]\n\n\nVisualizing Hypothesis\n\n# Plot \nwater_long %&gt;%\n  ggplot(aes(x = hr, y = aw_per_acre)) +\n  geom_boxplot(fill = \"#7F95D1\") +\n  labs(title = \"Applied Water per Acre by Hydrologic Region\",\n       x = \"Hydrologic Region\",\n       y = \"Applied Water per Acre\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1,size = 10))\n\n\n\n\nDistribution of applied water per acre across hydrologic regions."
  },
  {
    "objectID": "posts/crop-water-gamma/index.html#conclusion",
    "href": "posts/crop-water-gamma/index.html#conclusion",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "Conclusion",
    "text": "Conclusion\nThe box plot of applied water per acre by hydrologic region shows that the Colorado River and South Lahontan regions have the highest median water use. In contrast, regions such as San Francisco and the Central Coast show noticeably low levels. These figures align with the coefficient plot from the Gamma regression model. The hydrologic region is an essential predictor of applied water per acre, even without accounting for other factors."
  },
  {
    "objectID": "posts/crop-water-gamma/index.html#reference",
    "href": "posts/crop-water-gamma/index.html#reference",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "Reference",
    "text": "Reference\nCalifornia Department of Food and Agriculture. (2024). California agricultural production statistics [web page]. Available: https://www.cdfa.ca.gov/statistics. [Accessed: Dec.Â 4, 2025]\nCalifornia Department of Water Resources. (2020). Statewide Agricultural Water Use Data, 2016â€“2020 [data file]. Available: https://data.ca.gov/dataset/statewide-agricultural-water-use-data-2016-2020. [Accessed: Dec.Â 4, 2025]\nWikimedia Commons. (2024). Sisteme-de-irigatie.jpg [image file]. Available: https://commons.wikimedia.org/w/index.php?title=File:Sisteme-de-irigatie.jpg&oldid=838313884. [Accessed: Dec.Â 4, 2025]"
  },
  {
    "objectID": "posts/crop-water-gamma/index.html#footnotes",
    "href": "posts/crop-water-gamma/index.html#footnotes",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nCalifornia Department of Food and Agriculture. (2024). California agricultural production statistics [web page]. Available: https://www.cdfa.ca.gov/statistics. [Accessed: Dec.Â 4, 2025]â†©ï¸Ž"
  },
  {
    "objectID": "posts/ag-gamma/index.html",
    "href": "posts/ag-gamma/index.html",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "",
    "text": "California produces a large portion of the nationâ€™s fruits, nuts, and vegetables. Irrigated agriculture dominates water use in the state, and the amount of water applied varies by crop type, hydrologic region, and year.1\nThis dataset provides annual estimates of:\n\nApplied Water per Acre\nHydrologic Regions\n20 Crop Categories\nYears 2016 - 2020\n\nIn this blog post, we would like to dive in to understand how climate region, crop type, and year would influence our Gamma response variable, applied water per acre.\n\n\n\nCalifornia Department of Water Sources - Statewide Agricultural Land & Water Use (2016 -2020)"
  },
  {
    "objectID": "posts/ag-gamma/index.html#about",
    "href": "posts/ag-gamma/index.html#about",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "",
    "text": "California produces a large portion of the nationâ€™s fruits, nuts, and vegetables. Irrigated agriculture dominates water use in the state, and the amount of water applied varies by crop type, hydrologic region, and year.1\nThis dataset provides annual estimates of:\n\nApplied Water per Acre\nHydrologic Regions\n20 Crop Categories\nYears 2016 - 2020\n\nIn this blog post, we would like to dive in to understand how climate region, crop type, and year would influence our Gamma response variable, applied water per acre.\n\n\n\nCalifornia Department of Water Sources - Statewide Agricultural Land & Water Use (2016 -2020)"
  },
  {
    "objectID": "posts/ag-gamma/index.html#clear-the-environment-and-load-libraries",
    "href": "posts/ag-gamma/index.html#clear-the-environment-and-load-libraries",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "Clear the Environment and Load Libraries",
    "text": "Clear the Environment and Load Libraries\n\n# Clear the environment\nrm(list = ls())\n\n# Load in libraries\npacman::p_load(tidyverse, dplyr, here, readxl, pals, broom, knitr,\n               janitor, dagitty, ggdag, ggplot2, kableExtra)"
  },
  {
    "objectID": "posts/ag-gamma/index.html#load-and-explore-data",
    "href": "posts/ag-gamma/index.html#load-and-explore-data",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "Load and Explore Data",
    "text": "Load and Explore Data\nIn this section, we load the raw Excel file and prepare it for analysis. Real datasets often contain unnecessary columns, inconsistent variable names, or values that must be converted into usable formats. We use functions like clean_names(), select(), and pivot_longer() to transform the data into a tidy structure, where each row corresponds to a single crop-year-region combination. Finally, we filter out missing or zero values so the Gamma model, which requires positive continuous outcomes, can be correctly fit.\n\n# Read in data and clean the name to snake case and drop unused columns\nwater_raw &lt;- read_excel(here(\"posts\", \"ag-gamma\", \"data\",\n                  \"agricultural_water_use_data_2016_2020.xlsx\"),\n             sheet = \"Statewide_AW_Unit\", skip = 1) %&gt;% \n  clean_names() %&gt;% \n  select(!starts_with(\"x\"))\n\n# Pivot all crop columns, convert variable types, and drop missing rows\nwater_long &lt;- water_raw %&gt;% \n  pivot_longer(cols = -c(year, hr),\n               names_to = \"crop\",\n               values_to = \"aw_per_acre\") %&gt;% \n  mutate(aw_per_acre = as.numeric(aw_per_acre),\n         year = as.integer(year),\n         hr = as.factor(hr),\n         crop = as.factor(crop)) %&gt;% \n  filter(!is.na(aw_per_acre),\n         aw_per_acre &gt; 0)"
  },
  {
    "objectID": "posts/ag-gamma/index.html#exploratory-visualization",
    "href": "posts/ag-gamma/index.html#exploratory-visualization",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "Exploratory Visualization",
    "text": "Exploratory Visualization\nBefore fitting any statistical model, it is essential to understand the distribution of the variables. The violin plot visualizes how applied water per acre varies across crop types and reveals skewness, outliers, and general patterns. This helps justify the modeling choices and provides intuition about which predictors might influence water use.\n\n# Create a consistent color palette for crop types\ncrop_cols &lt;- setNames(alphabet()[1:length(levels(water_long$crop))], \n                      levels(water_long$crop))\n\nwater_long %&gt;%\nggplot(aes(x = crop, y = aw_per_acre, fill = crop)) +\n  geom_violin(trim = FALSE, alpha = 0.7) +\n  geom_boxplot(width = 0.1, outlier.shape = NA, alpha = 0.5) +\n  scale_fill_manual(values = crop_cols) +\n  coord_flip() +\n  theme_bw() +\n  theme(legend.position = \"none\",\n        plot.title = element_text(size = 14, face = \"bold\", hjust = 0),\n        axis.title.y = element_blank()) +\n  labs(y = \"Applied Water per Acre\")\n\n\n\n\nDistribution of applied water per acre across crop types, using violin + boxplot to visualize skewness and variability."
  },
  {
    "objectID": "posts/ag-gamma/index.html#dag-directed-acyclic-graph",
    "href": "posts/ag-gamma/index.html#dag-directed-acyclic-graph",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "DAG (Directed Acyclic Graph)",
    "text": "DAG (Directed Acyclic Graph)\nA Directed Acyclic Graph clarifies our assumptions about how variables influence each other. Letâ€™s dive into our variables:\n\nCrop Types influence water use because different crops require different irrigation levels\nThe hydrologic region affects crop type because different regions have different crops\nBoth year and hydrologic influence applied water per acre due to climate and resource availability\n\nThese relationships reflect scientific justification, including crop, hydrological region, and predictors in the regression model.\n\n\nCode\n# Draw a DAG\nwater_dag &lt;- dagitty(\"dag {\n               hr -&gt; crop\n               hr -&gt; aw_per_acre\n               year -&gt; crop\n               year -&gt; aw_per_acre\n               crop -&gt; aw_per_acre}\")\n\n# Assign coordinate for each variable nodes\ncoordinates(water_dag) &lt;- list(\n  x = c(hr = 0, year = 2, crop = 1, aw_per_acre = 3),\n  y = c(hr = 2, year = 2, crop = 1, aw_per_acre = 1))\n\n# Assign color for the nodes\nnode_colors &lt;- c(hr = \"#7F95D1\", year = \"#FF82A9\", \n                 crop = \"#FA824C\", aw_per_acre = \"#1B998B\")\n\n# Plot DAG\nggdag(water_dag, text = FALSE, node = FALSE) +\n  geom_dag_node(aes(fill = name), size = 12, shape = 21, color = \"white\") +\n  geom_dag_edges() +\n  scale_fill_manual(values = node_colors, name = \"Variables\",\n                    labels = c(aw_per_acre = \"Applied Water per Acre\",\n                               crop = \"Crop Type\",\n                               hr = \"Hydrologic Region\",\n                               year = \"Year\")) +\n  theme_minimal() +\n  theme(legend.title = element_text(size = 15, face = \"bold\", hjust = 0.5),\n        legend.position = \"right\",\n        legend.text = element_text(size = 12, face = \"bold\"),\n        axis.title = element_blank(),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid = element_blank(),\n        panel.background = element_blank(),\n        plot.margin = margin(10, 10, 10, 10))\n\n\n\n\n\nDAG representing hypothesized causal relationships among crop type, hydrologic region, year, and applied water per acre.\n\n\n\n\nThe DAG summarizes our assumptions about how crop type, hydrologic region, and year influence applied water per acre. Hydrologic region influences crop type because certain crops grow better in specific climates and soils. Both hydrologic region and year influences the response variable due to variation in precipitation, groundwater availability, and climate condition. Year affects crop distribution annually as they response directly to the market and climate."
  },
  {
    "objectID": "posts/ag-gamma/index.html#statistical-modeling",
    "href": "posts/ag-gamma/index.html#statistical-modeling",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "Statistical Modeling",
    "text": "Statistical Modeling\n\nWhy Gamma?\nThe Gamma Distribution with a log link works best with this data because the applied water per acre is positive and continuous. A positive continuous variable is a numerical value that can take any real number that is greater than zero.\nThe distribution is right-skewed, meaning most values are small, and a few very extreme values stretch the tail to the right, causing the data to cluster near the lower end and occasional extreme values that create an asymmetrical shape with a long right tail. Also, because it can only be positive.\nA multiplicative effect shows scientific results that change the outcome in proportion to the change. Rather than adding or subtracting a fixed amount, we can view the numbers as a percentage difference or twice as large. Multiplying the response is more meaningful than adding a constant amount, which makes the Gamma model fit right in.\n\n\nGamma Model in Statistical Notation\nThe mathematical form of the model explains this notation:\n\\[\n{Applied~Water} \\sim Gamma(\\mu, \\phi) \\\\\\\\\nlog(\\mu) = \\beta_0 + \\beta_1 * (Crop) + \\beta_2 * (Hydrologic~Region) + \\beta_3 *(Year)\n\\] The linear predictor for the mean is on the log scale, and the parameter of Gamma consists of the following:\n\n\\(\\mu\\) is expected applied water per acre\n\\(\\phi\\) is shape parameter and it controls with its size.\n\nLarger \\(\\phi\\) - distribution becomes more symmetric\nSmaller \\(\\phi\\) - distribution becomes more right-skewed and more spread out\n\n\n\n\nFit Model to Simulated Data\nTo demonstrate how the Gamma model works under the known parameters, we simulated 200 observations from a Gamma distribution with a log-linear mean structure. We set the \\(\\beta_0 = 1\\) and a slope \\(\\beta_1 = -0.4\\).\n\n# Initialize simulated random data\nset.seed(123)\nn &lt;- 200 # Sample Size\nbeta0 &lt;- 1 # Intercept\nbeta1 &lt;- -0.4 # Slope, controls strength and direction\nphi &lt;- 4 # Gamma Shape\n\n# Simulated a positive and right-skewed predictor\npredictor &lt;- rgamma(n, shape = 2, scale = 1)\n\n# Simulated Gamma-distribute response with mean\nresponse &lt;- rgamma(n, shape = phi, \n                   scale = exp(beta0 + beta1 * predictor) / phi) \n\nsim_data &lt;- tibble(predictor, response)\n\nsim_model &lt;- glm(response ~ predictor,\n                 data = sim_data,\n                 family = Gamma(link = \"log\"))\n\nsim_results &lt;- tidy(sim_model, conf.int = TRUE)\n\nsim_results %&gt;%\n  kbl(digits = 3, \n      caption = \"Gamma Regression Coefficients from Simulated Data (with 95% CI)\",\n      col.names = c(\"Term\", \"Estimate\", \"Std. Error\",\n                    \"Statistic\", \"p-value\",\n                    \"CI Lower\", \"CI Upper\")) %&gt;%\nkable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"),\n              full_width = FALSE, position = \"center\") %&gt;%\n  row_spec(0, bold = TRUE, background = \"#f0f0f0\")\n\n\nGamma Regression Coefficients from Simulated Data (with 95% CI)\n\n\nTerm\nEstimate\nStd. Error\nStatistic\np-value\nCI Lower\nCI Upper\n\n\n\n\n(Intercept)\n1.039\n0.063\n16.485\n0\n0.913\n1.167\n\n\npredictor\n-0.435\n0.028\n-15.321\n0\n-0.491\n-0.376\n\n\n\n\n\n\n\nParameter Recovery for Simulated Data\nDuring the simulation, the true parameters were:\n\nIntercepts: \\(\\beta_0 = 1\\)\nSlope: \\(\\beta_1 = -0.4\\)\n\nThe fitted Gamma regression model estimated coefficients very close to the true values we selected. The intercept estimate is approximately 1, and the slope estimate is approximately -0.4, indicating that the Gamma model with a log link successfully recovers the underlying parameters when the model assumptions hold. The simulation validates that the Gamma model applies to the water data.\n\n# Plot the simulated data\nggplot(sim_data, aes(predictor, response)) +\n  geom_point(alpha = 0.75) +\n  labs(x = \"Predictor\", y = \"Response\") +\n  theme(plot.title = element_text(size = 14, face = \"bold\", hjust = 0.5))\n\n\n\n\nSimulated Gamma-distributed response data with a log-linear relationship.\n\n\n\n\n\nggplot(sim_data, aes(x = predictor, y = response)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"glm\",\n              method.args = list(family = Gamma(link = \"log\")),\n              se = TRUE, color = \"red\", fill = \"lightblue\", size = 1.1) +\n  theme_bw() +\n  labs(x = \"Predictor\", y = \"Response\")\n\n\n\n\nSimulated Data with Fitted Gamma Regression Line"
  },
  {
    "objectID": "posts/ag-gamma/index.html#fit-to-real-life-data",
    "href": "posts/ag-gamma/index.html#fit-to-real-life-data",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "Fit to Real Life Data",
    "text": "Fit to Real Life Data\n\n\nCode\n# Fit Gamma Regression using log link to model applied water per acre\nwater_gamma_model &lt;- glm(aw_per_acre ~ crop + hr + year,\n           family = Gamma(link = \"log\"),\n           data = water_long)\n\n# Make the table presentable\nwater_results &lt;- tidy(water_gamma_model, conf.int = TRUE) %&gt;%\n  mutate(term = gsub(\"crop\", \"Crop: \", term),\n         term = gsub(\"hr\", \"Region: \", term)) %&gt;%\n  kable(format = \"html\",\n        caption = \"Gamma Regression Coefficients with 95% Confidence Intervals\",\n        col.names = c(\"Term\", \"Estimate\", \"Std. Error\", \"Statistic\", \"p-value\",\n                      \"CI (Lower)\", \"CI (Upper)\"), digits = 3) %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"),\n                full_width = FALSE, position = \"center\") %&gt;%\n  row_spec(0, bold = TRUE, background = \"#f0f0f0\")\n\n# Show table\nwater_results\n\n\n\nGamma Regression Coefficients with 95% Confidence Intervals\n\n\nTerm\nEstimate\nStd. Error\nStatistic\np-value\nCI (Lower)\nCI (Upper)\n\n\n\n\n(Intercept)\n31.163\n10.521\n2.962\n0.003\n10.738\n51.587\n\n\nCrop: almonds_pistachios\n-0.089\n0.044\n-2.011\n0.045\n-0.174\n-0.002\n\n\nCrop: avg_aw\n-0.337\n0.042\n-8.121\n0.000\n-0.419\n-0.256\n\n\nCrop: citrus_subtropical\n-0.185\n0.043\n-4.321\n0.000\n-0.268\n-0.101\n\n\nCrop: corn\n-0.420\n0.042\n-9.949\n0.000\n-0.502\n-0.337\n\n\nCrop: cotton\n-0.134\n0.053\n-2.511\n0.012\n-0.237\n-0.029\n\n\nCrop: cucurbits\n-0.687\n0.043\n-16.039\n0.000\n-0.771\n-0.603\n\n\nCrop: dry_beans\n-0.677\n0.046\n-14.880\n0.000\n-0.766\n-0.588\n\n\nCrop: grain\n-1.384\n0.042\n-33.322\n0.000\n-1.466\n-1.303\n\n\nCrop: onions_garlic\n-0.663\n0.043\n-15.367\n0.000\n-0.748\n-0.579\n\n\nCrop: other_deciduous\n-0.232\n0.042\n-5.524\n0.000\n-0.314\n-0.149\n\n\nCrop: other_field_Crop: s\n-0.240\n0.042\n-5.688\n0.000\n-0.322\n-0.157\n\n\nCrop: pasture\n0.102\n0.042\n2.463\n0.014\n0.021\n0.184\n\n\nCrop: potatoes\n-0.147\n0.045\n-3.280\n0.001\n-0.235\n-0.059\n\n\nCrop: rice\n0.084\n0.058\n1.454\n0.146\n-0.029\n0.199\n\n\nCrop: safflower\n-0.582\n0.047\n-12.367\n0.000\n-0.674\n-0.489\n\n\nCrop: sugar_beets\n-0.205\n0.158\n-1.301\n0.194\n-0.501\n0.119\n\n\nCrop: tomato_fresh\n-0.585\n0.114\n-5.140\n0.000\n-0.801\n-0.355\n\n\nCrop: tomato_processing\n-0.460\n0.045\n-10.110\n0.000\n-0.549\n-0.371\n\n\nCrop: truck_Crop: s\n-0.767\n0.042\n-18.462\n0.000\n-0.849\n-0.685\n\n\nCrop: vineyard\n-0.294\n0.043\n-6.895\n0.000\n-0.378\n-0.211\n\n\nRegion: 02_San Francisco Bay\n0.007\n0.037\n0.181\n0.856\n-0.066\n0.080\n\n\nRegion: 03_Central Coast\n0.038\n0.036\n1.062\n0.289\n-0.033\n0.109\n\n\nRegion: 04_South Coast\n0.238\n0.036\n6.528\n0.000\n0.166\n0.309\n\n\nRegion: 05_Sacramento River\n0.184\n0.036\n5.189\n0.000\n0.115\n0.254\n\n\nRegion: 06_San Joaquin River\n0.203\n0.035\n5.737\n0.000\n0.134\n0.273\n\n\nRegion: 07_Tulare Lake\n0.202\n0.036\n5.635\n0.000\n0.131\n0.272\n\n\nRegion: 08_North Lahontan\n0.120\n0.044\n2.728\n0.007\n0.034\n0.206\n\n\nRegion: 09_South Lahontan\n0.561\n0.038\n14.857\n0.000\n0.487\n0.635\n\n\nRegion: 10_Colorado River\n0.578\n0.036\n16.115\n0.000\n0.508\n0.648\n\n\nRegion: State\n0.243\n0.035\n6.869\n0.000\n0.173\n0.312\n\n\nyear\n-0.015\n0.005\n-2.847\n0.005\n-0.025\n-0.005\n\n\n\n\n\n\nCoefficient Plot\n\ntidy(water_gamma_model, conf.int = TRUE) %&gt;%\n  filter(grepl(\"^hr\", term)) %&gt;%\n  mutate(term = gsub(\"hr\", \"Region \", term), \n         term = reorder(term, estimate)) %&gt;%\n  ggplot(aes(x = term, y = estimate)) +\n  geom_point(size = 2) +\n  geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.15) +\n  coord_flip() +\n  theme_bw() +\n  labs(x = \"Hydrologic Region\", y = \"Estimate (log scale)\")\n\n\n\n\nHydrologic Region Effects with fitted Gamma regression line and 95% confidence interval"
  },
  {
    "objectID": "posts/ag-gamma/index.html#inference",
    "href": "posts/ag-gamma/index.html#inference",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "Inference",
    "text": "Inference\nWe are interested in if hydrologic region is associated with differences in applied water per acre, after adding all consideration for crop types and year.\n\nExplain Hypothesis in Plain-Language\nSome hydrologic regions require more applied water per acre than others, even after adjusting for crop type and year.\n\n\nHypothesis\n\\[\nH_0: \\beta_r = 0 \\quad \\text{(no difference in expected water use)} \\\\\nH_A: \\beta_r \\neq 0 \\quad \\text{(a region differs from the baseline region)}\n\\]\n\n\nVisualizing Hypothesis\n\n# Plot \nwater_long %&gt;%\n  ggplot(aes(x = hr, y = aw_per_acre)) +\n  geom_boxplot(fill = \"#7F95D1\") +\n  labs(title = \"Applied Water per Acre by Hydrologic Region\",\n       x = \"Hydrologic Region\",\n       y = \"Applied Water per Acre\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1,size = 10))\n\n\n\n\nDistribution of applied water per acre across hydrologic regions."
  },
  {
    "objectID": "posts/ag-gamma/index.html#conclusion",
    "href": "posts/ag-gamma/index.html#conclusion",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "Conclusion",
    "text": "Conclusion\nThe box plot of applied water per acre by hydrologic region shows that the Colorado River and South Lahontan regions have the highest median water use. In contrast, regions such as San Francisco and the Central Coast show noticeably low levels. These figures align with the coefficient plot from the Gamma regression model. The hydrologic region is an essential predictor of applied water per acre, even without accounting for other factors."
  },
  {
    "objectID": "posts/ag-gamma/index.html#reference",
    "href": "posts/ag-gamma/index.html#reference",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "Reference",
    "text": "Reference\nCalifornia Department of Food and Agriculture. (2024). California agricultural production statistics [web page]. Available: https://www.cdfa.ca.gov/statistics. [Accessed: Dec.Â 4, 2025]\nCalifornia Department of Water Resources. (2020). Statewide Agricultural Water Use Data, 2016â€“2020 [data file]. Available: https://data.ca.gov/dataset/statewide-agricultural-water-use-data-2016-2020. [Accessed: Dec.Â 4, 2025]\nWikimedia Commons. (2024). Sisteme-de-irigatie.jpg [image file]. Available: https://commons.wikimedia.org/w/index.php?title=File:Sisteme-de-irigatie.jpg&oldid=838313884. [Accessed: Dec.Â 4, 2025]"
  },
  {
    "objectID": "posts/ag-gamma/index.html#footnotes",
    "href": "posts/ag-gamma/index.html#footnotes",
    "title": "How Crop Type and Climate Zone Influence Agricultural Water Use in California",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nCalifornia Department of Food and Agriculture. (2024). California agricultural production statistics [web page]. Available: https://www.cdfa.ca.gov/statistics. [Accessed: Dec.Â 4, 2025]â†©ï¸Ž"
  }
]