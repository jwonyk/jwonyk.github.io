{
  "hash": "f50d28132fd4528155185381831cd2ee",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"How Crop Type and Climate Zone Influence Agricultural Water Use in California\"\ndate: 2025-12-11\ncategories: [MEDS, R]\nimage: water.jpg\nformat: \n  html:\n    embed-resources: true\n    standalone: true\n    toc: true\nbibliography: references.bib\ncitation:\n  url: \"https://jwonyk.github.io/posts/crop-water-gamma/\"\n---\n\n## Introduction\n\n#### About Data\n\nCalifornia produces a large portion of the nation's fruits, nuts, and vegetables. Irrigated agriculture dominates water use in the state, and the amount of water applied varies by crop type, hydrologic region, and year.[^1] The goal of this analysis is to understand how applied water per acre varies across crop types, hydrologic regions, and years using statewide data from 2016 - 2020.\n\n[^1]: California Department of Food and Agriculture. (2024). *California agricultural production statistics* \\[web page\\]. Available: https://www.cdfa.ca.gov/statistics.\n\nThis dataset provides annual estimates of:\n\n-   Applied Water per Acre\n-   Hydrologic Regions\n-   20 Crop Categories\n-   Years 2016 - 2020\n\nOur Research question is:\n\n**How do crop type, hydrologic region, and year influence the amount of applied irrigation water per acre in California?**\n\nWe will explore and examine the data and find what statistical model is appropriate.\n\n#### Data Access\n\nCalifornia Department of Water Sources - [*Statewide Agricultural Land & Water Use (2016 -2020)*](https://data.ca.gov/dataset/statewide-agricultural-water-use-data-2016-2020)\n\n#### Clear the Environment and Load Libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Clear the environment\nrm(list = ls())\n\n# Load in libraries\npacman::p_load(tidyverse, dplyr, stringr, here, readxl, pals, broom, knitr,\n               janitor, dagitty, ggdag, ggplot2, kableExtra, tools)\n```\n:::\n\n\n#### Load and Explore Data\n\nIn this section, we load the raw Excel file and prepare it for analysis. Real datasets often contain unnecessary columns, inconsistent variable names, or values that must be converted into usable formats. We use functions like `clean_names()`, `select()`, and `pivot_longer()` to transform the data into a tidy structure.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Read in data and clean the name to snake case and drop unused columns\nwater_raw <- read_excel(here(\"posts\", \"crop-water-gamma\", \"data\",\n                  \"agricultural_water_use_data_2016_2020.xlsx\"),\n             sheet = \"Statewide_AW_Unit\", skip = 1) %>% \n  clean_names() %>% \n  select(!starts_with(\"x\"))\n\n# Pivot all crop columns, convert variable types, and drop missing rows\nwater_long <- water_raw %>% \n  pivot_longer(cols = -c(year, hr),\n               names_to = \"crop\",\n               values_to = \"aw_per_acre\") %>% \n  mutate(aw_per_acre = as.numeric(aw_per_acre),\n         year = as.integer(year),\n         hr = as.factor(hr),\n         crop = as.factor(crop)) %>% \n  filter(!is.na(aw_per_acre),\n         aw_per_acre > 0)\n```\n:::\n\n\n#### Data Cleaning Method and Explanation\n\nThe raw Excel file had many generated placeholders with columns labeled `X1`, `X2`, etc. which contained no data. We removed these using `select(!start_with(\"x\"))`. The dataset is structured in a wide format where each crop is stored in its own column. In order for us to fit regression model, we need to put the crops into one column which was achieved using `pivot_longer()` which converts into a tidy dataset that represents year-region-crop combination that corresponding with **applied water per acre**.\n\nWe also used `clean_names()` from `janitor` package that standardized all column names in snake case throughout the analysis for better readability.\n\nSome observations showed zero applied water, which occurred for several reasons, such as the field not needing irrigation due to adequate rainfall, the land being empty and requiring no irrigation, or other reasons.\n\nBecause our research question asks how crop type, hydrologic region, and year influence the amount of irrigation water applied per acre, our focus is on variation in irrigation intensity among fields that were actually irrigated, not on the separate decision to withhold irrigation. For this reason, we restrict our analysis to positive applied-water observations and filter out zeroes.\n\n#### Exploratory Visualization\n\nBefore fitting any statistical model, it is essential to understand the distribution of the variables. The violin plot visualizes how applied water per acre varies across crop types and reveals skewness, outliers, and general patterns. This helps justify the modeling choices and provides intuition about which predictors might influence water use.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Create a consistent color palette for crop types\ncrop_cols <- setNames(alphabet()[1:length(levels(water_long$crop))], \n                      levels(water_long$crop))\n\nwater_long %>%\nggplot(aes(x = crop, y = aw_per_acre, fill = crop)) +\n  geom_violin(trim = FALSE, alpha = 0.7) +\n  geom_boxplot(width = 0.1, outlier.shape = NA, alpha = 0.5) +\n  scale_fill_manual(values = crop_cols) +\n  coord_flip() +\n  theme_bw() +\n  theme(legend.position = \"none\",\n        plot.title = element_text(size = 14, face = \"bold\", hjust = 0),\n        axis.title.y = element_blank()) +\n  labs(y = \"Applied Water per Acre\")\n```\n\n::: {.cell-output-display}\n![Distribution of applied water per acre across crop types, using violin + boxplot to visualize skewness and variability.](index_files/figure-html/plot-to-check-1.png){width=672}\n:::\n:::\n\n\nThe violin plot shows that applied water per acre is strongly right-skewed for most crops. The widest portions of the violins occur at lower values, indicating that most observations involve relatively low water use. At the same time, long right tails reflect a small number of farm-years with much higher water application. Most observations fall between 1 and 3 acre-feet per acre, with a few extreme values extending the distribution to the right.\n\nHere, we are noticing some violin plots extending below zero on the x-axis. This phenomenon is called **Kernel Density Estimation** where the violin plots use to smooth the distribution of the data and provide a visual estimation of the entire population's probable values, not just the observed data points.[^2]\n\n[^2]: Mode Analytics. (2021). *Violin Plots 101: Visualizing Distribution and Probability Density* \\[web page\\]. Available: https://mode.com/blog/violin-plot-examples.\n\n## DAG (Directed Acyclic Graph)\n\nA Directed Acyclic Graph clarifies our assumptions about how variables influence each other. Let's dive into our variables:\n\n-   Crop Types influence water use because different crops require different irrigation levels\n\n-   The hydrologic region affects crop type because different regions have different crops\n\n-   Both year and hydrologic influence applied water per acre due to climate and resource availability\n\nThese relationships reflect scientific justification, including crop, hydrological region, and predictors in the regression model.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Draw a DAG\nwater_dag <- dagitty(\"dag{\n               hr -> crop\n               hr -> aw_per_acre\n               year -> crop\n               year -> aw_per_acre\n               crop -> aw_per_acre}\")\n\n# Assign coordinate for each variable nodes\ncoordinates(water_dag) <- list(\n  x = c(hr = 0, year = 2, crop = 1, aw_per_acre = 3),\n  y = c(hr = 2, year = 2, crop = 1, aw_per_acre = 1))\n\n# Assign color for the nodes\nnode_colors <- c(hr = \"#7F95D1\", year = \"#FF82A9\", \n                 crop = \"#FA824C\", aw_per_acre = \"#1B998B\")\n\n# Plot DAG\nggdag(water_dag, text = FALSE, node = FALSE) +\n  geom_dag_node(aes(fill = name), size = 12, shape = 21, color = \"white\") +\n  geom_dag_edges() +\n  scale_fill_manual(values = node_colors, name = \"Variables\",\n                    labels = c(aw_per_acre = \"Applied Water per Acre\",\n                               crop = \"Crop Type\",\n                               hr = \"Hydrologic Region\",\n                               year = \"Year\")) +\n  theme_minimal() +\n  theme(legend.title = element_text(size = 15, face = \"bold\", hjust = 0.5),\n        legend.position = \"right\",\n        legend.text = element_text(size = 12, face = \"bold\"),\n        axis.title = element_blank(),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid = element_blank(),\n        panel.background = element_blank(),\n        plot.margin = margin(10, 10, 10, 10))\n```\n\n::: {.cell-output-display}\n![DAG representing hypothesized causal relationships among crop type, hydrologic region, year, and applied water per acre.](index_files/figure-html/casual-dag-1.png){width=672}\n:::\n:::\n\n\nThe DAG summarizes our assumptions about how crop type, hydrologic region, and year influence applied water per acre. Hydrologic region influences crop type because certain crops grow better in specific climates and soils. Both hydrologic region and year influences the response variable due to variation in precipitation, groundwater availability, and climate condition. Year affects crop distribution annually as they response directly to the market and climate.\n\n## Statistical Modeling\n\n#### Why Gamma?\n\nThe Gamma Distribution with a log link would be appropriate for our dataset because applied water per acre is **positive, continuous, and right-skewed**. Rather than adding or subtracting a fixed amount of water, the model describes how water use scales up or down from the baseline. Each coefficient shows how much lower or higher expected water use is relative to the baseline condition. In other words, instead of saying \"this crop uses n amount more acre-foot of water\", the model would tell us that the crop or region would use n% more / less water than average.\n\nAn interaction between crop type and hydrologic region could further expand our research scope to include region-specific crop water requirements. We will revisit a different model for this next time.\n\n#### Gamma Model in Statistical Notation\n\nThe mathematical form of the model explains this notation:\n\n$$\n\\begin{align*}\n&\\text{Applied Water} \\sim Gamma(\\mu, \\phi) \\\\\n\\log(\\mu) = \\beta_0 + &\\beta_1 (\\text{Crop}) + \\beta_2 (\\text{Hydrologic Region}) + \\beta_3 (\\text{Year})\n\\end{align*}\n$$\n\nThe linear predictor for the mean is on the log scale, and the parameter of Gamma consists of the following:\n\n-   $\\mu$ is expected applied water per acre\n\n-   $\\phi$ is shape parameter and it controls with its size.\n\n    -   Larger $\\phi$ - distribution becomes more symmetric\n\n    -   Smaller $\\phi$ - distribution becomes more right-skewed and more spread out\n\nThe mathematical form of the log link for Gamma model:\n\n$$\n\\text {Expected water use} = exp(\\text {linear predictor or }\\beta)\n$$\n\n#### Fit Model to Simulated Data\n\nTo demonstrate how the Gamma model works under the known parameters, we simulated 1000 observations from a Gamma distribution with a log-linear mean structure. We set the $\\beta_0 = 1$ and a slope $\\beta_1 = -0.4$.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Initialize simulated random data\nset.seed(123)\nn <- 1000 # Sample Size\nbeta0 <- 1 # Intercept\nbeta1 <- -0.4 # Slope, controls strength and direction\nphi <- 4 # Gamma Shape\n\n# Simulated a positive and right-skewed predictor\npredictor <- rgamma(n, shape = 2, scale = 1)\n\n# Simulated Gamma-distribute response with mean\nresponse <- rgamma(n, shape = phi, \n                   scale = exp(beta0 + beta1 * predictor) / phi) \n\nsim_data <- tibble(predictor, response)\n\nsim_model <- glm(response ~ predictor,\n                 data = sim_data,\n                 family = Gamma(link = \"log\"))\n\nsim_results <- tidy(sim_model, conf.int = TRUE)\n\nsim_results %>%\n  kbl(digits = 3, \n      caption = \"Gamma Regression Coefficients from Simulated Data (with 95% CI)\",\n      col.names = c(\"Term\", \"Estimate\", \"Std. Error\",\n                    \"Statistic\", \"p-value\",\n                    \"CI Lower\", \"CI Upper\")) %>%\nkable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"),\n              full_width = FALSE, position = \"center\") %>%\n  row_spec(0, bold = TRUE, background = \"#f0f0f0\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Gamma Regression Coefficients from Simulated Data (with 95% CI)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> Term </th>\n   <th style=\"text-align:right;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> Estimate </th>\n   <th style=\"text-align:right;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> Std. Error </th>\n   <th style=\"text-align:right;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> Statistic </th>\n   <th style=\"text-align:right;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> p-value </th>\n   <th style=\"text-align:right;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> CI Lower </th>\n   <th style=\"text-align:right;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> CI Upper </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 1.017 </td>\n   <td style=\"text-align:right;\"> 0.027 </td>\n   <td style=\"text-align:right;\"> 37.187 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.963 </td>\n   <td style=\"text-align:right;\"> 1.071 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> predictor </td>\n   <td style=\"text-align:right;\"> -0.415 </td>\n   <td style=\"text-align:right;\"> 0.012 </td>\n   <td style=\"text-align:right;\"> -34.652 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> -0.439 </td>\n   <td style=\"text-align:right;\"> -0.392 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nIncreasing the sample size to 1000 observations leads to tighter confidence intervals and demonstrates that the Gamma model can reliably recover the assumed parameters.\n\n#### Parameter Recovery for Simulated Data\n\nDuring the simulation, the true parameters were:\n\n-   Intercepts: $\\beta_0 = 1$\n-   Slope: $\\beta_1 = -0.4$\n\nThe fitted Gamma regression model estimated coefficients very close to the true values we selected. The intercept estimate is approximately 1, and the slope estimate is approximately -0.4, indicating that the Gamma model with a log link successfully recovers the underlying parameters when the model assumptions hold. The simulation validates that the Gamma model applies to the water data.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Plot the simulated data with estimates\nggplot(sim_data, aes(x = predictor, y = response)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"glm\",\n              method.args = list(family = Gamma(link = \"log\")),\n              se = TRUE, color = \"red\", fill = \"blue\", size = 1) +\n  theme_bw() +\n  labs(x = \"Predictor\", y = \"Response\")\n```\n\n::: {.cell-output-display}\n![Simulated Data with Fitted Gamma Regression Line](index_files/figure-html/simulate-estimate-1.png){width=672}\n:::\n:::\n\n\n#### Fit to Real Life Data\n\nAfter confirming that the Gamma model performs well on simulated data, we fit the model. This step allows us to quantify how **applied water per acre** varies across crop types, hydrologic regions, and years in real-world conditions.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Fit Gamma Regression using log link to model applied water per acre\nwater_gamma_model <- glm(aw_per_acre ~ crop + hr + factor(year),\n           family = Gamma(link = \"log\"),\n           data = water_long)\n\n# Make the table presentable\nwater_results <- tidy(water_gamma_model, conf.int = TRUE) %>%\n  mutate(term = gsub(\"^crop\", \"Crop: \", term),\n         term = gsub(\"^hr\", \"Region: \", term),\n         term = gsub(\"factor\\\\(year\\\\)\", \"Year: \", term),\n         term = gsub(\"Region: \\\\d+_\", \"Region: \", term),\n         term = gsub(\"other_field_Crop: s\", \"Other Field Crops\", term),\n         term = gsub(\"truck_Crop: s\", \"Truck Crops\", term),\n         term = gsub(\"_\", \" \", term),\n         term = toTitleCase(term)) %>%\n  kable(format = \"html\",\n        caption = \"Gamma Regression Coefficients with 95% Confidence Intervals\",\n        col.names = c(\"Term\", \"Estimate\", \"Std. Error\", \"Statistic\", \"p-value\",\n                      \"CI (Lower)\", \"CI (Upper)\"), digits = 3,\n        align = \"c\") %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"),\n                full_width = FALSE, position = \"center\") %>%\n  row_spec(0, bold = TRUE, background = \"#f0f0f0\")\n\n# Show table\nwater_results\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Gamma Regression Coefficients with 95% Confidence Intervals</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:center;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> Term </th>\n   <th style=\"text-align:center;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> Estimate </th>\n   <th style=\"text-align:center;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> Std. Error </th>\n   <th style=\"text-align:center;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> Statistic </th>\n   <th style=\"text-align:center;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> p-value </th>\n   <th style=\"text-align:center;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> CI (Lower) </th>\n   <th style=\"text-align:center;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> CI (Upper) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> (Intercept) </td>\n   <td style=\"text-align:center;\"> 1.281 </td>\n   <td style=\"text-align:center;\"> 0.041 </td>\n   <td style=\"text-align:center;\"> 31.156 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> 1.200 </td>\n   <td style=\"text-align:center;\"> 1.363 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Crop: Almonds Pistachios </td>\n   <td style=\"text-align:center;\"> -0.091 </td>\n   <td style=\"text-align:center;\"> 0.043 </td>\n   <td style=\"text-align:center;\"> -2.099 </td>\n   <td style=\"text-align:center;\"> 0.036 </td>\n   <td style=\"text-align:center;\"> -0.175 </td>\n   <td style=\"text-align:center;\"> -0.006 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Crop: Avg Aw </td>\n   <td style=\"text-align:center;\"> -0.338 </td>\n   <td style=\"text-align:center;\"> 0.041 </td>\n   <td style=\"text-align:center;\"> -8.283 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> -0.419 </td>\n   <td style=\"text-align:center;\"> -0.258 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Crop: Citrus Subtropical </td>\n   <td style=\"text-align:center;\"> -0.187 </td>\n   <td style=\"text-align:center;\"> 0.042 </td>\n   <td style=\"text-align:center;\"> -4.454 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> -0.269 </td>\n   <td style=\"text-align:center;\"> -0.105 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Crop: Corn </td>\n   <td style=\"text-align:center;\"> -0.419 </td>\n   <td style=\"text-align:center;\"> 0.041 </td>\n   <td style=\"text-align:center;\"> -10.097 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> -0.500 </td>\n   <td style=\"text-align:center;\"> -0.338 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Crop: Cotton </td>\n   <td style=\"text-align:center;\"> -0.132 </td>\n   <td style=\"text-align:center;\"> 0.052 </td>\n   <td style=\"text-align:center;\"> -2.522 </td>\n   <td style=\"text-align:center;\"> 0.012 </td>\n   <td style=\"text-align:center;\"> -0.234 </td>\n   <td style=\"text-align:center;\"> -0.029 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Crop: Cucurbits </td>\n   <td style=\"text-align:center;\"> -0.685 </td>\n   <td style=\"text-align:center;\"> 0.042 </td>\n   <td style=\"text-align:center;\"> -16.265 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> -0.768 </td>\n   <td style=\"text-align:center;\"> -0.603 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Crop: Dry Beans </td>\n   <td style=\"text-align:center;\"> -0.675 </td>\n   <td style=\"text-align:center;\"> 0.045 </td>\n   <td style=\"text-align:center;\"> -15.083 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> -0.763 </td>\n   <td style=\"text-align:center;\"> -0.587 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Crop: Grain </td>\n   <td style=\"text-align:center;\"> -1.391 </td>\n   <td style=\"text-align:center;\"> 0.041 </td>\n   <td style=\"text-align:center;\"> -34.037 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> -1.471 </td>\n   <td style=\"text-align:center;\"> -1.311 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Crop: Onions Garlic </td>\n   <td style=\"text-align:center;\"> -0.669 </td>\n   <td style=\"text-align:center;\"> 0.042 </td>\n   <td style=\"text-align:center;\"> -15.756 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> -0.752 </td>\n   <td style=\"text-align:center;\"> -0.586 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Crop: Other Deciduous </td>\n   <td style=\"text-align:center;\"> -0.233 </td>\n   <td style=\"text-align:center;\"> 0.041 </td>\n   <td style=\"text-align:center;\"> -5.656 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> -0.314 </td>\n   <td style=\"text-align:center;\"> -0.152 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Crop: Other Field Crops </td>\n   <td style=\"text-align:center;\"> -0.237 </td>\n   <td style=\"text-align:center;\"> 0.041 </td>\n   <td style=\"text-align:center;\"> -5.717 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> -0.318 </td>\n   <td style=\"text-align:center;\"> -0.156 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Crop: Pasture </td>\n   <td style=\"text-align:center;\"> 0.101 </td>\n   <td style=\"text-align:center;\"> 0.041 </td>\n   <td style=\"text-align:center;\"> 2.476 </td>\n   <td style=\"text-align:center;\"> 0.013 </td>\n   <td style=\"text-align:center;\"> 0.021 </td>\n   <td style=\"text-align:center;\"> 0.181 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Crop: Potatoes </td>\n   <td style=\"text-align:center;\"> -0.149 </td>\n   <td style=\"text-align:center;\"> 0.044 </td>\n   <td style=\"text-align:center;\"> -3.390 </td>\n   <td style=\"text-align:center;\"> 0.001 </td>\n   <td style=\"text-align:center;\"> -0.236 </td>\n   <td style=\"text-align:center;\"> -0.063 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Crop: Rice </td>\n   <td style=\"text-align:center;\"> 0.087 </td>\n   <td style=\"text-align:center;\"> 0.057 </td>\n   <td style=\"text-align:center;\"> 1.524 </td>\n   <td style=\"text-align:center;\"> 0.128 </td>\n   <td style=\"text-align:center;\"> -0.024 </td>\n   <td style=\"text-align:center;\"> 0.199 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Crop: Safflower </td>\n   <td style=\"text-align:center;\"> -0.581 </td>\n   <td style=\"text-align:center;\"> 0.046 </td>\n   <td style=\"text-align:center;\"> -12.555 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> -0.671 </td>\n   <td style=\"text-align:center;\"> -0.490 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Crop: Sugar Beets </td>\n   <td style=\"text-align:center;\"> -0.247 </td>\n   <td style=\"text-align:center;\"> 0.156 </td>\n   <td style=\"text-align:center;\"> -1.589 </td>\n   <td style=\"text-align:center;\"> 0.112 </td>\n   <td style=\"text-align:center;\"> -0.539 </td>\n   <td style=\"text-align:center;\"> 0.072 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Crop: Tomato Fresh </td>\n   <td style=\"text-align:center;\"> -0.626 </td>\n   <td style=\"text-align:center;\"> 0.112 </td>\n   <td style=\"text-align:center;\"> -5.573 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> -0.840 </td>\n   <td style=\"text-align:center;\"> -0.399 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Crop: Tomato Processing </td>\n   <td style=\"text-align:center;\"> -0.454 </td>\n   <td style=\"text-align:center;\"> 0.045 </td>\n   <td style=\"text-align:center;\"> -10.140 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> -0.541 </td>\n   <td style=\"text-align:center;\"> -0.366 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Crop: Truck Crops </td>\n   <td style=\"text-align:center;\"> -0.770 </td>\n   <td style=\"text-align:center;\"> 0.041 </td>\n   <td style=\"text-align:center;\"> -18.838 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> -0.850 </td>\n   <td style=\"text-align:center;\"> -0.689 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Crop: Vineyard </td>\n   <td style=\"text-align:center;\"> -0.293 </td>\n   <td style=\"text-align:center;\"> 0.042 </td>\n   <td style=\"text-align:center;\"> -6.983 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> -0.375 </td>\n   <td style=\"text-align:center;\"> -0.211 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Region: San Francisco Bay </td>\n   <td style=\"text-align:center;\"> 0.005 </td>\n   <td style=\"text-align:center;\"> 0.036 </td>\n   <td style=\"text-align:center;\"> 0.132 </td>\n   <td style=\"text-align:center;\"> 0.895 </td>\n   <td style=\"text-align:center;\"> -0.067 </td>\n   <td style=\"text-align:center;\"> 0.076 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Region: Central Coast </td>\n   <td style=\"text-align:center;\"> 0.038 </td>\n   <td style=\"text-align:center;\"> 0.035 </td>\n   <td style=\"text-align:center;\"> 1.065 </td>\n   <td style=\"text-align:center;\"> 0.287 </td>\n   <td style=\"text-align:center;\"> -0.032 </td>\n   <td style=\"text-align:center;\"> 0.107 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Region: South Coast </td>\n   <td style=\"text-align:center;\"> 0.237 </td>\n   <td style=\"text-align:center;\"> 0.036 </td>\n   <td style=\"text-align:center;\"> 6.619 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> 0.167 </td>\n   <td style=\"text-align:center;\"> 0.308 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Region: Sacramento River </td>\n   <td style=\"text-align:center;\"> 0.181 </td>\n   <td style=\"text-align:center;\"> 0.035 </td>\n   <td style=\"text-align:center;\"> 5.190 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> 0.113 </td>\n   <td style=\"text-align:center;\"> 0.250 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Region: San Joaquin River </td>\n   <td style=\"text-align:center;\"> 0.201 </td>\n   <td style=\"text-align:center;\"> 0.035 </td>\n   <td style=\"text-align:center;\"> 5.767 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> 0.133 </td>\n   <td style=\"text-align:center;\"> 0.270 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Region: Tulare Lake </td>\n   <td style=\"text-align:center;\"> 0.200 </td>\n   <td style=\"text-align:center;\"> 0.035 </td>\n   <td style=\"text-align:center;\"> 5.667 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> 0.130 </td>\n   <td style=\"text-align:center;\"> 0.269 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Region: North Lahontan </td>\n   <td style=\"text-align:center;\"> 0.121 </td>\n   <td style=\"text-align:center;\"> 0.043 </td>\n   <td style=\"text-align:center;\"> 2.809 </td>\n   <td style=\"text-align:center;\"> 0.005 </td>\n   <td style=\"text-align:center;\"> 0.037 </td>\n   <td style=\"text-align:center;\"> 0.206 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Region: South Lahontan </td>\n   <td style=\"text-align:center;\"> 0.563 </td>\n   <td style=\"text-align:center;\"> 0.037 </td>\n   <td style=\"text-align:center;\"> 15.152 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> 0.490 </td>\n   <td style=\"text-align:center;\"> 0.636 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Region: Colorado River </td>\n   <td style=\"text-align:center;\"> 0.581 </td>\n   <td style=\"text-align:center;\"> 0.035 </td>\n   <td style=\"text-align:center;\"> 16.458 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> 0.511 </td>\n   <td style=\"text-align:center;\"> 0.650 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Region: State </td>\n   <td style=\"text-align:center;\"> 0.242 </td>\n   <td style=\"text-align:center;\"> 0.035 </td>\n   <td style=\"text-align:center;\"> 6.955 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> 0.174 </td>\n   <td style=\"text-align:center;\"> 0.310 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Year: 2017 </td>\n   <td style=\"text-align:center;\"> -0.109 </td>\n   <td style=\"text-align:center;\"> 0.023 </td>\n   <td style=\"text-align:center;\"> -4.766 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> -0.153 </td>\n   <td style=\"text-align:center;\"> -0.064 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Year: 2018 </td>\n   <td style=\"text-align:center;\"> -0.043 </td>\n   <td style=\"text-align:center;\"> 0.023 </td>\n   <td style=\"text-align:center;\"> -1.881 </td>\n   <td style=\"text-align:center;\"> 0.060 </td>\n   <td style=\"text-align:center;\"> -0.089 </td>\n   <td style=\"text-align:center;\"> 0.002 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Year: 2019 </td>\n   <td style=\"text-align:center;\"> -0.137 </td>\n   <td style=\"text-align:center;\"> 0.023 </td>\n   <td style=\"text-align:center;\"> -5.963 </td>\n   <td style=\"text-align:center;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> -0.182 </td>\n   <td style=\"text-align:center;\"> -0.092 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Year: 2020 </td>\n   <td style=\"text-align:center;\"> -0.062 </td>\n   <td style=\"text-align:center;\"> 0.023 </td>\n   <td style=\"text-align:center;\"> -2.678 </td>\n   <td style=\"text-align:center;\"> 0.008 </td>\n   <td style=\"text-align:center;\"> -0.107 </td>\n   <td style=\"text-align:center;\"> -0.016 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nRegions differ substantially in expected water use even after accounting for crop type and year. The Colorado River (0.58) and South Lahontan (0.56) regions show the largest positive coefficients. These regions are estimated to use approximately 75-80% more water per acre than the baseline region.\n\nWe know the percentage by calculating log link:\n\n$exp(\\beta \\text{ of Colorado River}) = exp(0.58) \\approx 1.79$\n\n$exp(\\beta \\text{ of South Laho.ntan}) = exp(0.56) \\approx 1.75$\n\nThese regional differences are consistent with climate patterns across California. Inland regions such as the Colorado River and South Lahontan are known to have hotter, drier conditions and higher evaporative demand (the atmosphere’s tendency to remove moisture from soil and plants), requiring higher irrigation. On the other hand, coastal regions such as the San Francisco Bay and Central Coast experience cooler temperatures, corresponding to lower irrigation needs.\n\n#### Coefficient Plot\n\nWe visualize the estimated regression coefficients along with their 95% confidence intervals. This coefficient plot provides the uncertainty of each predictor's association with applied water per acre.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ntidy(water_gamma_model, conf.int = TRUE) %>%\n  filter(grepl(\"^hr\", term)) %>%\n  mutate(term = gsub(\"^hr\\\\d+_\", \"\", term),\n         term = gsub(\"_\", \" \", term),\n         term = reorder(term, estimate)) %>%\n  ggplot(aes(x = term, y = estimate)) +\n  geom_point(size = 2) +\n  geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.15) +\n  coord_flip() +\n  theme_bw() +\n  labs(x = \"Hydrologic Region\", y = \"Estimate (log scale)\")\n```\n\n::: {.cell-output-display}\n![Hydrologic Region Effects with fitted Gamma regression line and 95% confidence interval](index_files/figure-html/coef-plot-hr-1.png){width=672}\n:::\n:::\n\n\n## Inference\n\nWe are interested in if hydrologic region is associated with differences in applied water per acre, after adding all consideration for crop types and year.\n\n#### Explain Hypothesis in Plain-Language\n\nSome hydrologic regions require more applied water per acre than others, even after adjusting for crop type and year.\n\n$$\n\\begin{aligned}\nH_0:&\\ \\beta_r = 0 \\quad \\text{(no difference in expected water use)} \\\\\nH_A:&\\ \\beta_r \\neq 0 \\quad \\text{(a region differs from the baseline region)}\n\\end{aligned}\n$$\n\n#### Visualizing Hypothesis\n\nBefore interpreting hypothesis test results, use visualization to examine applied water per acre by hydrologic region. The figure will help to evaluate how water use differs across regions in the observed data and results of the Gamma regression model.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Plot \nggplot(water_long, aes(x = hr, y = aw_per_acre, fill = hr)) +\n  geom_violin(trim = FALSE, alpha = 0.5) +\n  geom_boxplot(width = 0.15, outlier.shape = NA) +\n  scale_fill_brewer(palette = \"Set3\") +\n  scale_x_discrete(labels = function(x) \n    {x <- gsub(\"^\\\\d+_\", \"\", x)\n     x <- gsub(\"_\", \" \", x)}) +\n  labs(x = \"Hydrologic Region\",\n       y = \"Applied Water per Acre\") +\n  theme_minimal() +\n  theme(legend.position = \"none\",\n        axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![Distribution of applied water per acre across hydrologic regions.](index_files/figure-html/region-boxplot-1.png){width=672}\n:::\n:::\n\nThe combined violin and box plot displays both the full distribution of water use within each region and key summary statistics, allowing us to evaluate differences in central tendency, variability, and skewness across regions.\n\n## Conclusion\n\nThis analysis shows that the hydrologic region is a key determinant of agricultural irrigation intensity in California. Even after accounting for crop type and year, inland regions consistently require more applied water per acre than coastal regions, as the hotter, drier air in inland climates causes water to evaporate more quickly from soils and crops than crop composition alone. Supported by the hypothesis visualization, which shows shifts in the distribution, reinforcing the model-based evidence of regional differences. By focusing on irrigated fields, this analysis isolates variation in irrigation intensity but does not model irrigation decisions or region-specific crop responses. Future work could incorporate crop–region interactions to understand better how water requirements vary across California's diverse hydrologic landscapes.\n\n## Reference\n\nCalifornia Department of Water Resources. (2020). *Statewide Agricultural Water Use Data, 2016–2020* \\[data file\\]. Available: https://data.ca.gov/dataset/statewide-agricultural-water-use-data-2016-2020. \\[Accessed: Oct. 25, 2025\\]\n\nWikimedia Commons. (2024). *Sisteme-de-irigatie.jpg* \\[image file\\]. Available: https://commons.wikimedia.org/w/index.php?title=File:Sisteme-de-irigatie.jpg&oldid=838313884. \\[Accessed: Dec. 4, 2025\\]\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}