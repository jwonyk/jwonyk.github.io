{
  "hash": "6618a3e35f32dace1e3551be67d07374",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"How Crop Type and Climate Zone Influence Agricultural Water Use in California\"\ndate: 2025-12-04\ncategories: [MEDS, R]\nimage: water.jpg\nexecute:\n  echo: true\n  warning: false\n  message: false\n  freeze: auto\nbibliography: references.bib\ncitation:\n  url: \"https://jwonyk.github.io/posts/crop-water-gamma/\"\n---\n\n## About\n\n#### Dataset Description\n\nCalifornia produces a large portion of the nation's fruits, nuts, and vegetables. Irrigated agriculture dominates water use in the state, and the amount of water applied varies by crop type, hydrologic region, and year.[^1]\n\n[^1]: California Department of Food and Agriculture. (2024). *California agricultural production statistics* \\[web page\\]. Available: https://www.cdfa.ca.gov/statistics. \\[Accessed: Dec. 4, 2025\\]\n\nThis dataset provides annual estimates of:\n\n-   Applied Water per Acre\n-   Hydrologic Regions\n-   20 Crop Categories\n-   Years 2016 - 2020\n\nIn this blog post, we would like to dive in to understand how climate region, crop type, and year would influence our Gamma response variable, *applied water per acre*.\n\n#### Data Access\n\nCalifornia Department of Water Sources - [*Statewide Agricultural Land & Water Use (2016 -2020)*](https://data.ca.gov/dataset/statewide-agricultural-water-use-data-2016-2020)\n\n## Clear the Environment and Load Libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Clear the environment\nrm(list = ls())\n\n# Load in libraries\npacman::p_load(tidyverse, dplyr, here, readxl, pals, broom, knitr,\n               janitor, dagitty, ggdag, ggplot2, kableExtra)\n```\n:::\n\n\n## Load and Explore Data\n\nIn this section, we load the raw Excel file and prepare it for analysis. Real datasets often contain unnecessary columns, inconsistent variable names, or values that must be converted into usable formats. We use functions like `clean_names()`, `select()`, and `pivot_longer()` to transform the data into a tidy structure, where each row corresponds to a single crop-year-region combination. Finally, we filter out *missing or zero values* so the Gamma model, which requires positive continuous outcomes, can be correctly fit.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Read in data and clean the name to snake case and drop unused columns\nwater_raw <- read_excel(here(\"posts\", \"ag-gamma\", \"data\",\n                  \"agricultural_water_use_data_2016_2020.xlsx\"),\n             sheet = \"Statewide_AW_Unit\", skip = 1) %>% \n  clean_names() %>% \n  select(!starts_with(\"x\"))\n\n# Pivot all crop columns, convert variable types, and drop missing rows\nwater_long <- water_raw %>% \n  pivot_longer(cols = -c(year, hr),\n               names_to = \"crop\",\n               values_to = \"aw_per_acre\") %>% \n  mutate(aw_per_acre = as.numeric(aw_per_acre),\n         year = as.integer(year),\n         hr = as.factor(hr),\n         crop = as.factor(crop)) %>% \n  filter(!is.na(aw_per_acre),\n         aw_per_acre > 0)\n```\n:::\n\n\n## Exploratory Visualization\n\nBefore fitting any statistical model, it is essential to understand the distribution of the variables. The violin plot visualizes how applied water per acre varies across crop types and reveals skewness, outliers, and general patterns. This helps justify the modeling choices and provides intuition about which predictors might influence water use.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a consistent color palette for crop types\ncrop_cols <- setNames(alphabet()[1:length(levels(water_long$crop))], \n                      levels(water_long$crop))\n\nwater_long %>%\nggplot(aes(x = crop, y = aw_per_acre, fill = crop)) +\n  geom_violin(trim = FALSE, alpha = 0.7) +\n  geom_boxplot(width = 0.1, outlier.shape = NA, alpha = 0.5) +\n  scale_fill_manual(values = crop_cols) +\n  coord_flip() +\n  theme_bw() +\n  theme(legend.position = \"none\",\n        plot.title = element_text(size = 14, face = \"bold\", hjust = 0),\n        axis.title.y = element_blank()) +\n  labs(y = \"Applied Water per Acre\")\n```\n\n::: {.cell-output-display}\n![Distribution of applied water per acre across crop types, using violin + boxplot to visualize skewness and variability.](index_files/figure-html/plot-to-check-1.png){width=672}\n:::\n:::\n\n\n## DAG (Directed Acyclic Graph)\n\nA Directed Acyclic Graph clarifies our assumptions about how variables influence each other. Let's dive into our variables:\n\n-   Crop Types influence water use because different crops require different irrigation levels\n\n-   The hydrologic region affects crop type because different regions have different crops\n\n-   Both year and hydrologic influence applied water per acre due to climate and resource availability\n\nThese relationships reflect scientific justification, including crop, hydrological region, and predictors in the regression model.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Draw a DAG\nwater_dag <- dagitty(\"dag {\n               hr -> crop\n               hr -> aw_per_acre\n               year -> crop\n               year -> aw_per_acre\n               crop -> aw_per_acre}\")\n\n# Assign coordinate for each variable nodes\ncoordinates(water_dag) <- list(\n  x = c(hr = 0, year = 2, crop = 1, aw_per_acre = 3),\n  y = c(hr = 2, year = 2, crop = 1, aw_per_acre = 1))\n\n# Assign color for the nodes\nnode_colors <- c(hr = \"#7F95D1\", year = \"#FF82A9\", \n                 crop = \"#FA824C\", aw_per_acre = \"#1B998B\")\n\n# Plot DAG\nggdag(water_dag, text = FALSE, node = FALSE) +\n  geom_dag_node(aes(fill = name), size = 12, shape = 21, color = \"white\") +\n  geom_dag_edges() +\n  scale_fill_manual(values = node_colors, name = \"Variables\",\n                    labels = c(aw_per_acre = \"Applied Water per Acre\",\n                               crop = \"Crop Type\",\n                               hr = \"Hydrologic Region\",\n                               year = \"Year\")) +\n  theme_minimal() +\n  theme(legend.title = element_text(size = 15, face = \"bold\", hjust = 0.5),\n        legend.position = \"right\",\n        legend.text = element_text(size = 12, face = \"bold\"),\n        axis.title = element_blank(),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        panel.grid = element_blank(),\n        panel.background = element_blank(),\n        plot.margin = margin(10, 10, 10, 10))\n```\n\n::: {.cell-output-display}\n![DAG representing hypothesized causal relationships among crop type, hydrologic region, year, and applied water per acre.](index_files/figure-html/casual-dag-1.png){width=672}\n:::\n:::\n\n\nThe DAG summarizes our assumptions about how crop type, hydrologic region, and year influence applied water per acre. Hydrologic region influences crop type because certain crops grow better in specific climates and soils. Both hydrologic region and year influences the response variable due to variation in precipitation, groundwater availability, and climate condition. Year affects crop distribution annually as they response directly to the market and climate.\n\n## Statistical Modeling\n\n#### Why Gamma?\n\nThe Gamma Distribution with a log link works best with this data because the applied water per acre is positive and continuous. A positive continuous variable is a numerical value that can take *any real number* that is greater than *zero*.\n\nThe distribution is right-skewed, meaning most values are small, and a few very extreme values stretch the tail to the right, causing the data to cluster near the lower end and occasional extreme values that create an asymmetrical shape with a long right tail. Also, because it can only be positive.\n\nA multiplicative effect shows scientific results that change the outcome in proportion to the change. Rather than adding or subtracting a fixed amount, we can view the numbers as a percentage difference or twice as large. Multiplying the response is more meaningful than adding a constant amount, which makes the Gamma model fit right in.\n\n#### Gamma Model in Statistical Notation\n\nThe mathematical form of the model explains this notation:\n\n$$\n{Applied~Water} \\sim Gamma(\\mu, \\phi) \\\\\\\\ \nlog(\\mu) = \\beta_0 + \\beta_1 * (Crop) + \\beta_2 * (Hydrologic~Region) + \\beta_3 *(Year)\n$$ The linear predictor for the mean is on the log scale, and the parameter of Gamma consists of the following:\n\n-   $\\mu$ is expected applied water per acre\n\n-   $\\phi$ is shape parameter and it controls with its size.\n\n    -   Larger $\\phi$ - distribution becomes more symmetric\n\n    -   Smaller $\\phi$ - distribution becomes more right-skewed and more spread out\n\n#### Fit Model to Simulated Data\n\nTo demonstrate how the Gamma model works under the known parameters, we simulated 200 observations from a Gamma distribution with a log-linear mean structure. We set the $\\beta_0 = 1$ and a slope $\\beta_1 = -0.4$.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Initialize simulated random data\nset.seed(123)\nn <- 200 # Sample Size\nbeta0 <- 1 # Intercept\nbeta1 <- -0.4 # Slope, controls strength and direction\nphi <- 4 # Gamma Shape\n\n# Simulated a positive and right-skewed predictor\npredictor <- rgamma(n, shape = 2, scale = 1)\n\n# Simulated Gamma-distribute response with mean\nresponse <- rgamma(n, shape = phi, \n                   scale = exp(beta0 + beta1 * predictor) / phi) \n\nsim_data <- tibble(predictor, response)\n\nsim_model <- glm(response ~ predictor,\n                 data = sim_data,\n                 family = Gamma(link = \"log\"))\n\nsim_results <- tidy(sim_model, conf.int = TRUE)\n\nsim_results %>%\n  kbl(digits = 3, \n      caption = \"Gamma Regression Coefficients from Simulated Data (with 95% CI)\",\n      col.names = c(\"Term\", \"Estimate\", \"Std. Error\",\n                    \"Statistic\", \"p-value\",\n                    \"CI Lower\", \"CI Upper\")) %>%\nkable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"),\n              full_width = FALSE, position = \"center\") %>%\n  row_spec(0, bold = TRUE, background = \"#f0f0f0\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Gamma Regression Coefficients from Simulated Data (with 95% CI)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> Term </th>\n   <th style=\"text-align:right;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> Estimate </th>\n   <th style=\"text-align:right;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> Std. Error </th>\n   <th style=\"text-align:right;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> Statistic </th>\n   <th style=\"text-align:right;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> p-value </th>\n   <th style=\"text-align:right;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> CI Lower </th>\n   <th style=\"text-align:right;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> CI Upper </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 1.039 </td>\n   <td style=\"text-align:right;\"> 0.063 </td>\n   <td style=\"text-align:right;\"> 16.485 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.913 </td>\n   <td style=\"text-align:right;\"> 1.167 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> predictor </td>\n   <td style=\"text-align:right;\"> -0.435 </td>\n   <td style=\"text-align:right;\"> 0.028 </td>\n   <td style=\"text-align:right;\"> -15.321 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> -0.491 </td>\n   <td style=\"text-align:right;\"> -0.376 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n#### Parameter Recovery for Simulated Data\n\nDuring the simulation, the true parameters were:\n\n-   Intercepts: $\\beta_0 = 1$\n-   Slope: $\\beta_1 = -0.4$\n\nThe fitted Gamma regression model estimated coefficients very close to the true values we selected. The intercept estimate is approximately 1, and the slope estimate is approximately -0.4, indicating that the Gamma model with a log link successfully recovers the underlying parameters when the model assumptions hold. The simulation validates that the Gamma model applies to the water data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot the simulated data\nggplot(sim_data, aes(predictor, response)) +\n  geom_point(alpha = 0.75) +\n  labs(x = \"Predictor\", y = \"Response\") +\n  theme(plot.title = element_text(size = 14, face = \"bold\", hjust = 0.5))\n```\n\n::: {.cell-output-display}\n![Simulated Gamma-distributed response data with a log-linear relationship.](index_files/figure-html/simulate-plot-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(sim_data, aes(x = predictor, y = response)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"glm\",\n              method.args = list(family = Gamma(link = \"log\")),\n              se = TRUE, color = \"red\", fill = \"lightblue\", size = 1.1) +\n  theme_bw() +\n  labs(x = \"Predictor\", y = \"Response\")\n```\n\n::: {.cell-output-display}\n![Simulated Data with Fitted Gamma Regression Line](index_files/figure-html/simulate-estimate-1.png){width=672}\n:::\n:::\n\n\n## Fit to Real Life Data\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Fit Gamma Regression using log link to model applied water per acre\nwater_gamma_model <- glm(aw_per_acre ~ crop + hr + year,\n           family = Gamma(link = \"log\"),\n           data = water_long)\n\n# Make the table presentable\nwater_results <- tidy(water_gamma_model, conf.int = TRUE) %>%\n  mutate(term = gsub(\"crop\", \"Crop: \", term),\n         term = gsub(\"hr\", \"Region: \", term)) %>%\n  kable(format = \"html\",\n        caption = \"Gamma Regression Coefficients with 95% Confidence Intervals\",\n        col.names = c(\"Term\", \"Estimate\", \"Std. Error\", \"Statistic\", \"p-value\",\n                      \"CI (Lower)\", \"CI (Upper)\"), digits = 3) %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"),\n                full_width = FALSE, position = \"center\") %>%\n  row_spec(0, bold = TRUE, background = \"#f0f0f0\")\n\n# Show table\nwater_results\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Gamma Regression Coefficients with 95% Confidence Intervals</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> Term </th>\n   <th style=\"text-align:right;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> Estimate </th>\n   <th style=\"text-align:right;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> Std. Error </th>\n   <th style=\"text-align:right;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> Statistic </th>\n   <th style=\"text-align:right;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> p-value </th>\n   <th style=\"text-align:right;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> CI (Lower) </th>\n   <th style=\"text-align:right;font-weight: bold;background-color: rgba(240, 240, 240, 255) !important;\"> CI (Upper) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 31.163 </td>\n   <td style=\"text-align:right;\"> 10.521 </td>\n   <td style=\"text-align:right;\"> 2.962 </td>\n   <td style=\"text-align:right;\"> 0.003 </td>\n   <td style=\"text-align:right;\"> 10.738 </td>\n   <td style=\"text-align:right;\"> 51.587 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop: almonds_pistachios </td>\n   <td style=\"text-align:right;\"> -0.089 </td>\n   <td style=\"text-align:right;\"> 0.044 </td>\n   <td style=\"text-align:right;\"> -2.011 </td>\n   <td style=\"text-align:right;\"> 0.045 </td>\n   <td style=\"text-align:right;\"> -0.174 </td>\n   <td style=\"text-align:right;\"> -0.002 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop: avg_aw </td>\n   <td style=\"text-align:right;\"> -0.337 </td>\n   <td style=\"text-align:right;\"> 0.042 </td>\n   <td style=\"text-align:right;\"> -8.121 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> -0.419 </td>\n   <td style=\"text-align:right;\"> -0.256 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop: citrus_subtropical </td>\n   <td style=\"text-align:right;\"> -0.185 </td>\n   <td style=\"text-align:right;\"> 0.043 </td>\n   <td style=\"text-align:right;\"> -4.321 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> -0.268 </td>\n   <td style=\"text-align:right;\"> -0.101 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop: corn </td>\n   <td style=\"text-align:right;\"> -0.420 </td>\n   <td style=\"text-align:right;\"> 0.042 </td>\n   <td style=\"text-align:right;\"> -9.949 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> -0.502 </td>\n   <td style=\"text-align:right;\"> -0.337 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop: cotton </td>\n   <td style=\"text-align:right;\"> -0.134 </td>\n   <td style=\"text-align:right;\"> 0.053 </td>\n   <td style=\"text-align:right;\"> -2.511 </td>\n   <td style=\"text-align:right;\"> 0.012 </td>\n   <td style=\"text-align:right;\"> -0.237 </td>\n   <td style=\"text-align:right;\"> -0.029 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop: cucurbits </td>\n   <td style=\"text-align:right;\"> -0.687 </td>\n   <td style=\"text-align:right;\"> 0.043 </td>\n   <td style=\"text-align:right;\"> -16.039 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> -0.771 </td>\n   <td style=\"text-align:right;\"> -0.603 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop: dry_beans </td>\n   <td style=\"text-align:right;\"> -0.677 </td>\n   <td style=\"text-align:right;\"> 0.046 </td>\n   <td style=\"text-align:right;\"> -14.880 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> -0.766 </td>\n   <td style=\"text-align:right;\"> -0.588 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop: grain </td>\n   <td style=\"text-align:right;\"> -1.384 </td>\n   <td style=\"text-align:right;\"> 0.042 </td>\n   <td style=\"text-align:right;\"> -33.322 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> -1.466 </td>\n   <td style=\"text-align:right;\"> -1.303 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop: onions_garlic </td>\n   <td style=\"text-align:right;\"> -0.663 </td>\n   <td style=\"text-align:right;\"> 0.043 </td>\n   <td style=\"text-align:right;\"> -15.367 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> -0.748 </td>\n   <td style=\"text-align:right;\"> -0.579 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop: other_deciduous </td>\n   <td style=\"text-align:right;\"> -0.232 </td>\n   <td style=\"text-align:right;\"> 0.042 </td>\n   <td style=\"text-align:right;\"> -5.524 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> -0.314 </td>\n   <td style=\"text-align:right;\"> -0.149 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop: other_field_Crop: s </td>\n   <td style=\"text-align:right;\"> -0.240 </td>\n   <td style=\"text-align:right;\"> 0.042 </td>\n   <td style=\"text-align:right;\"> -5.688 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> -0.322 </td>\n   <td style=\"text-align:right;\"> -0.157 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop: pasture </td>\n   <td style=\"text-align:right;\"> 0.102 </td>\n   <td style=\"text-align:right;\"> 0.042 </td>\n   <td style=\"text-align:right;\"> 2.463 </td>\n   <td style=\"text-align:right;\"> 0.014 </td>\n   <td style=\"text-align:right;\"> 0.021 </td>\n   <td style=\"text-align:right;\"> 0.184 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop: potatoes </td>\n   <td style=\"text-align:right;\"> -0.147 </td>\n   <td style=\"text-align:right;\"> 0.045 </td>\n   <td style=\"text-align:right;\"> -3.280 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> -0.235 </td>\n   <td style=\"text-align:right;\"> -0.059 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop: rice </td>\n   <td style=\"text-align:right;\"> 0.084 </td>\n   <td style=\"text-align:right;\"> 0.058 </td>\n   <td style=\"text-align:right;\"> 1.454 </td>\n   <td style=\"text-align:right;\"> 0.146 </td>\n   <td style=\"text-align:right;\"> -0.029 </td>\n   <td style=\"text-align:right;\"> 0.199 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop: safflower </td>\n   <td style=\"text-align:right;\"> -0.582 </td>\n   <td style=\"text-align:right;\"> 0.047 </td>\n   <td style=\"text-align:right;\"> -12.367 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> -0.674 </td>\n   <td style=\"text-align:right;\"> -0.489 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop: sugar_beets </td>\n   <td style=\"text-align:right;\"> -0.205 </td>\n   <td style=\"text-align:right;\"> 0.158 </td>\n   <td style=\"text-align:right;\"> -1.301 </td>\n   <td style=\"text-align:right;\"> 0.194 </td>\n   <td style=\"text-align:right;\"> -0.501 </td>\n   <td style=\"text-align:right;\"> 0.119 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop: tomato_fresh </td>\n   <td style=\"text-align:right;\"> -0.585 </td>\n   <td style=\"text-align:right;\"> 0.114 </td>\n   <td style=\"text-align:right;\"> -5.140 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> -0.801 </td>\n   <td style=\"text-align:right;\"> -0.355 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop: tomato_processing </td>\n   <td style=\"text-align:right;\"> -0.460 </td>\n   <td style=\"text-align:right;\"> 0.045 </td>\n   <td style=\"text-align:right;\"> -10.110 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> -0.549 </td>\n   <td style=\"text-align:right;\"> -0.371 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop: truck_Crop: s </td>\n   <td style=\"text-align:right;\"> -0.767 </td>\n   <td style=\"text-align:right;\"> 0.042 </td>\n   <td style=\"text-align:right;\"> -18.462 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> -0.849 </td>\n   <td style=\"text-align:right;\"> -0.685 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop: vineyard </td>\n   <td style=\"text-align:right;\"> -0.294 </td>\n   <td style=\"text-align:right;\"> 0.043 </td>\n   <td style=\"text-align:right;\"> -6.895 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> -0.378 </td>\n   <td style=\"text-align:right;\"> -0.211 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Region: 02_San Francisco Bay </td>\n   <td style=\"text-align:right;\"> 0.007 </td>\n   <td style=\"text-align:right;\"> 0.037 </td>\n   <td style=\"text-align:right;\"> 0.181 </td>\n   <td style=\"text-align:right;\"> 0.856 </td>\n   <td style=\"text-align:right;\"> -0.066 </td>\n   <td style=\"text-align:right;\"> 0.080 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Region: 03_Central Coast </td>\n   <td style=\"text-align:right;\"> 0.038 </td>\n   <td style=\"text-align:right;\"> 0.036 </td>\n   <td style=\"text-align:right;\"> 1.062 </td>\n   <td style=\"text-align:right;\"> 0.289 </td>\n   <td style=\"text-align:right;\"> -0.033 </td>\n   <td style=\"text-align:right;\"> 0.109 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Region: 04_South Coast </td>\n   <td style=\"text-align:right;\"> 0.238 </td>\n   <td style=\"text-align:right;\"> 0.036 </td>\n   <td style=\"text-align:right;\"> 6.528 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.166 </td>\n   <td style=\"text-align:right;\"> 0.309 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Region: 05_Sacramento River </td>\n   <td style=\"text-align:right;\"> 0.184 </td>\n   <td style=\"text-align:right;\"> 0.036 </td>\n   <td style=\"text-align:right;\"> 5.189 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.115 </td>\n   <td style=\"text-align:right;\"> 0.254 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Region: 06_San Joaquin River </td>\n   <td style=\"text-align:right;\"> 0.203 </td>\n   <td style=\"text-align:right;\"> 0.035 </td>\n   <td style=\"text-align:right;\"> 5.737 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.134 </td>\n   <td style=\"text-align:right;\"> 0.273 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Region: 07_Tulare Lake </td>\n   <td style=\"text-align:right;\"> 0.202 </td>\n   <td style=\"text-align:right;\"> 0.036 </td>\n   <td style=\"text-align:right;\"> 5.635 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.131 </td>\n   <td style=\"text-align:right;\"> 0.272 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Region: 08_North Lahontan </td>\n   <td style=\"text-align:right;\"> 0.120 </td>\n   <td style=\"text-align:right;\"> 0.044 </td>\n   <td style=\"text-align:right;\"> 2.728 </td>\n   <td style=\"text-align:right;\"> 0.007 </td>\n   <td style=\"text-align:right;\"> 0.034 </td>\n   <td style=\"text-align:right;\"> 0.206 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Region: 09_South Lahontan </td>\n   <td style=\"text-align:right;\"> 0.561 </td>\n   <td style=\"text-align:right;\"> 0.038 </td>\n   <td style=\"text-align:right;\"> 14.857 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.487 </td>\n   <td style=\"text-align:right;\"> 0.635 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Region: 10_Colorado River </td>\n   <td style=\"text-align:right;\"> 0.578 </td>\n   <td style=\"text-align:right;\"> 0.036 </td>\n   <td style=\"text-align:right;\"> 16.115 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.508 </td>\n   <td style=\"text-align:right;\"> 0.648 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Region: State </td>\n   <td style=\"text-align:right;\"> 0.243 </td>\n   <td style=\"text-align:right;\"> 0.035 </td>\n   <td style=\"text-align:right;\"> 6.869 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.173 </td>\n   <td style=\"text-align:right;\"> 0.312 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> year </td>\n   <td style=\"text-align:right;\"> -0.015 </td>\n   <td style=\"text-align:right;\"> 0.005 </td>\n   <td style=\"text-align:right;\"> -2.847 </td>\n   <td style=\"text-align:right;\"> 0.005 </td>\n   <td style=\"text-align:right;\"> -0.025 </td>\n   <td style=\"text-align:right;\"> -0.005 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n#### Coefficient Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(water_gamma_model, conf.int = TRUE) %>%\n  filter(grepl(\"^hr\", term)) %>%\n  mutate(term = gsub(\"hr\", \"Region \", term), \n         term = reorder(term, estimate)) %>%\n  ggplot(aes(x = term, y = estimate)) +\n  geom_point(size = 2) +\n  geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.15) +\n  coord_flip() +\n  theme_bw() +\n  labs(x = \"Hydrologic Region\", y = \"Estimate (log scale)\")\n```\n\n::: {.cell-output-display}\n![Hydrologic Region Effects with fitted Gamma regression line and 95% confidence interval](index_files/figure-html/coef-plot-hr-1.png){width=672}\n:::\n:::\n\n\n## Inference\n\nWe are interested in if hydrologic region is associated with differences in applied water per acre, after adding all consideration for crop types and year.\n\n#### Explain Hypothesis in Plain-Language\n\nSome hydrologic regions require more applied water per acre than others, even after adjusting for crop type and year.\n\n#### Hypothesis\n\n$$\nH_0: \\beta_r = 0 \\quad \\text{(no difference in expected water use)} \\\\\nH_A: \\beta_r \\neq 0 \\quad \\text{(a region differs from the baseline region)}\n$$\n\n#### Visualizing Hypothesis\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot \nwater_long %>%\n  ggplot(aes(x = hr, y = aw_per_acre)) +\n  geom_boxplot(fill = \"#7F95D1\") +\n  labs(title = \"Applied Water per Acre by Hydrologic Region\",\n       x = \"Hydrologic Region\",\n       y = \"Applied Water per Acre\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1,size = 10))\n```\n\n::: {.cell-output-display}\n![Distribution of applied water per acre across hydrologic regions.](index_files/figure-html/region-boxplot-1.png){width=672}\n:::\n:::\n\n\n## Conclusion\n\nThe box plot of applied water per acre by hydrologic region shows that the Colorado River and South Lahontan regions have the highest median water use. In contrast, regions such as San Francisco and the Central Coast show noticeably low levels. These figures align with the coefficient plot from the Gamma regression model. The hydrologic region is an essential predictor of applied water per acre, even without accounting for other factors.\n\n## Reference\n\nCalifornia Department of Food and Agriculture. (2024). *California agricultural production statistics* \\[web page\\]. Available: https://www.cdfa.ca.gov/statistics. \\[Accessed: Dec. 4, 2025\\]\n\nCalifornia Department of Water Resources. (2020). *Statewide Agricultural Water Use Data, 2016â€“2020* \\[data file\\]. Available: https://data.ca.gov/dataset/statewide-agricultural-water-use-data-2016-2020. \\[Accessed: Dec. 4, 2025\\]\n\nWikimedia Commons. (2024). *Sisteme-de-irigatie.jpg* \\[image file\\]. Available: https://commons.wikimedia.org/w/index.php?title=File:Sisteme-de-irigatie.jpg&oldid=838313884. \\[Accessed: Dec. 4, 2025\\]\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}