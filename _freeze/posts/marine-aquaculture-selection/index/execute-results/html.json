{
  "hash": "94a39f6506cd80e0922791dd2d6165df",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Marine Aquaculture Suitability Analysis for Oyster and Mussel\"\ndate: 2025-12-12\ncategories: [MEDS, R]\nimage: aquaculture.jpg\nformat: \n  html:\n    embed-resources: true\n    standalone: true\n    toc: true\nbibliography: references.bib\ncitation:\n  url: \"https://jwonyk.github.io/posts/marine-aquaculture-selection\"\n---\n\n**Github Repository**: https://github.com/jwonyk/marine-aquaculture-selection\n\n## Introduction\n\nExclusive Economic Zones (EEZs) are marine areas extending up to 200 nautical miles from the coast, where the U.S. has special rights to use and manage resources. The growth of marine aquaculture has increased the need for spatial analyses that help identify where different species are most likely to thrive. For shellfish farmers, selecting suitable offshore locations is crucial, which entails determining the proper environmental conditions, such as temperature and depth, that strongly influence survival, growth, overall yield potential, and understanding how to support more sustainable development. This analysis addresses the question:\n\n**Which U.S. West Coast EEZ regions provide the most suitable environmental conditions for oyster and mussel aquaculture based on sea surface temperature (SST) and depth?**\n\n## Data Description\n\nThis analysis integrates multiple spatial datasets to evaluate the suitability of aquaculture along the U.S. West Coast ([NOAA’s 5km Daily Global Satellite Sea Surface Temperature Anomaly v3.1](https://coralreefwatch.noaa.gov/product/5km/index_5km_ssta.php)). Sea surface temperature (SST) rasters represent average annual temperatures from 2008–2012 and capture long-term thermal conditions relevant to shellfish growth. These rasters are converted from Kelvin to Celsius to align with biological thresholds reported in the literature.\n\nBathymetry data ([General Bathymetric Chart of the Oceans (GEBCO)](https://www.gebco.net/data_and_products/gridded_bathymetry_data/#area)) are used to represent ocean depth, which is a key constraint for aquaculture infrastructure and species survival. Depth rasters are resampled and aligned with the SST grid to allow direct cell-by-cell comparison.\n\nExclusive Economic Zones (EEZs) boundaries are obtained from [MarineRegions.org](http://MarineRegions.org) and define the marine areas over which the United States has jurisdiction for resource use up to 200 nautical miles offshore. These boundaries allow suitability to be summarized by management region rather than individual grid cells.\n\nSpecies-specific temperature and depth thresholds are applied for oysters and mussels to reflect differences in environmental tolerance and habitat requirements are retrieved from [SeaLifeBase](https://www.sealifebase.ca/search.php).\n\n## Analysis Setup\n\nWe are going to clear the environment and load necessary packages.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Clear environment and load required packages\nrm(list = ls())\npacman::p_load(tidyverse, sf, here, \n               terra, stars, tmap, units,\n               ggplot2, viridisLite, dplyr, testthat,\n               janitor, knitr, kableExtra, paletteer)\n```\n:::\n\n\n## Explore the Data\n\nIn this step, I prepare the environmental datasets used to evaluate aquaculture suitability along the U.S. West Coast. I begin by loading multiple years of sea surface temperature rasters, check coordinate reference systems (CRS) to see spatial layers align correctly for later operations, computing their mean to represent long-term thermal conditions, and then converting values from Kelvin to Celsius for ecological interpretation. Depth data are read in and resampled to match the sea surface temperature raster's resolution, extent, and coordinate reference system, ensuring cell-by-cell comparisons. Both sea surface temperature and depth layers are then reclassified into binary suitable and unsuitable categories based on species-specific environmental thresholds. The resulting suitability rasters are cropped and masked to EEZ boundaries.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Assign file into lists for average annual sea surface temperature (08-12)\nsst_files <- list.files(here(\"posts\", \"marine-aquaculture-selection\", \"data\"), \n                      pattern = \"average_annual_sst_\", \n                      full.names = TRUE)\n\n# Check to make sure all SST files are loading\nif(length(sst_files) != 5) {\n  \n  stop(\"Fatal error. Please check the file names or path.\")\n  \n} \n\n# Read in raster objects and shapefile\neez <- st_read(here(\"posts\", \"marine-aquaculture-selection\", \"data\", \n                    \"wc_regions_clean\", \"wc_regions_clean.shp\"), \n               quiet = TRUE)\ndepth_rast <- rast(here(\"posts\", \"marine-aquaculture-selection\", \n                        \"data\", \"depth.tif\"))\nsst_rast <- rast(sst_files)\n\n\n\n# Align EEZ shapefile CRS to SST CRS\nif(!identical(st_crs(eez), st_crs(sst_rast))) {\n  \n  message(\"EEZ CRS does not match SST CRS! Transforming EEZ to match SST.\")\n  eez <- st_transform(eez, st_crs(sst_rast))\n  \n} else {\n  \n  message(\"EEZ CRS matches SST CRS.\")\n  \n}\n\n# Match depth raster to SST CRS using `project()`\nif(!crs(depth_rast) == crs(sst_rast)) {\n  \n  message(\"Depth CRS does not match SST CRS! Projecting depth raster.\")\n  depth_rast <- project(depth_rast, sst_rast, method = \"near\")\n  \n} else {\n  \n  message(\"Depth CRS matches SST CRS.\")\n  \n}\n```\n:::\n\n\n## Compute Mean SST and Convert to Celsius\n\nBecause SST data span multiple years, we average the rasters to obtain a mean temperature surface, which is then converted from Kelvin to Celsius.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get the average of SST in Kelvin ()\nsst_mean_kelvin <- mean(sst_rast, na.rm = TRUE)\n\n# Convert the average of SST in Celsius\nsst_mean_celsius <- sst_mean_kelvin - 273.15\n\n# Rename the column to make sure no confusion later\nnames(sst_mean_celsius) <- \"sst_mean_celsius\"\n```\n:::\n\n\n## Align Depth Raster to SST Raster\n\nThe depth raster must match the SST raster’s resolution and extent to ensure accurate cell-by-cell comparison during suitability calculations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Align depth raster to SST\ndepth_crop <- crop(depth_rast, sst_mean_celsius)\n\n# Resample to match SST resolution (use the nearest neighbor)\ndepth_resample <- resample(depth_crop, \n                           sst_mean_celsius, \n                           method = \"near\")\n\n# Rename the column to make sure no confusion later\nnames(depth_resample) <- \"depth_resample\"\n```\n:::\n\n\n## Reclassifying & Combine for Suitability\n\nWe convert continuous SST values into a binary suitability layer based on oyster temperature thresholds from the literature. Similarly, depth values are reclassified to identify areas within the allowable depth range for oyster growth. Multiplying the two binary layers identifies grid cells that meet both environmental requirements.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Oyster thresholds\noyster_sst_min <- 11\noyster_sst_max <- 30\noyster_depth_min <- -70\noyster_depth_max <- 0\n\n# Reclassify SST suitability\n# 0 = unsuitable & 1 = suitable\noyster_sst_suitable <- lapp(sst_mean_celsius, \n                            fun = function(x)\n                              ifelse(x >= 11 & x <= 30, 1, 0))\n\n\n# Reclassify depth\noyster_depth_suitable <- lapp(depth_resample,\n                              fun = function(x)\n                                ifelse(x >= -70 & x <= 0, 1, 0))\n\n# Combine classified SST and depth by multiplying them both\noyster_cells_suitable <- oyster_sst_suitable * oyster_depth_suitable\n```\n:::\n\n\n## Crop and Mask Suitability to EEZ Boundaries\n\nWe restrict the area of interest to U.S. West Coast Exclusive Economic Zones (EEZs), ensuring suitability is evaluated only within jurisdictional waters.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Convert EEZ object to SpatVector to use as `terra` ojbect\neez_vector <- vect(eez)\n\n# Crop suitability raster to EEZ bounding box (reduce processing)\noyster_crop <- crop(oyster_cells_suitable, eez_vector)\n\n# Mask cells outside the EEZ\noyster_eez <- mask(oyster_crop, eez_vector)\n```\n:::\n\n\n## Compute Suitable Cells to Area\n\nEach raster cell’s area is computed and summed within each EEZ to quantify total suitable habitat in square kilometers.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Compute per-cell area (in km^2)\ncell_area_km2 <- cellSize(oyster_eez, unit = \"km\")\n\n# Multiply area raster by suitable, 0 vs 1, only return suitable cells\noyster_area <- oyster_eez * cell_area_km2\n\n# Rename the column to make sure no confusion later\nnames(oyster_area) <- \"suitable_area_km2\"\n```\n:::\n\n\n## Join Suitability Results to EEZ Polygons\n\nWe join calculated suitable area values back to EEZ polygons so they can be visualized on a choropleth map.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Rename ID column to easier access\neez <- eez %>% \n  rename(eez_id = rgn_id)\n\n# Convert into SpatVector after name update\neez_vector <- vect(eez)\n\n# Rasterize EEZ polygons to match raster grid before `zonal()`\neez_id_raster <- rasterize(eez_vector, oyster_area, field = \"eez_id\")\n```\n:::\n\n\n## Calculate and Summarize Suitable Area by EEZ\n\nWe sum all suitable raster cells within each EEZ and join these results to the EEZ polygons.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Add up suitable area within each EEZ zone\noyster_area_eez <- zonal(oyster_area, eez_id_raster,\n                         fun = \"sum\",\n                         na.rm = TRUE) %>% \n  as.data.frame()\n\n# Join with EEZ polygons for mapping purposes\neez_oyster_join <- eez %>% \n  left_join(oyster_area_eez, by = \"eez_id\")\n\n# Create table of suitable area ranked by EEZ\neez_oyster_join %>% \n  st_drop_geometry() %>% \n  arrange(desc(suitable_area_km2)) %>% \n  kable(\"html\", \n        col.names = c(\"Region\", \"Region Code\", \"Area(m^2)\",\n                      \"EEZ ID\", \"EEZ Area (km^2)\", \"Suitable Area (km^2)\"),\n        caption = \"Suitable Oyster Habitat Area by EEZ (km^2)\",\n        align = \"c\") %>% \n  kable_styling(full_width = FALSE, \n                bootstrap_options = c(\"striped\", \"hover\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Suitable Oyster Habitat Area by EEZ (km^2)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:center;\"> Region </th>\n   <th style=\"text-align:center;\"> Region Code </th>\n   <th style=\"text-align:center;\"> Area(m^2) </th>\n   <th style=\"text-align:center;\"> EEZ ID </th>\n   <th style=\"text-align:center;\"> EEZ Area (km^2) </th>\n   <th style=\"text-align:center;\"> Suitable Area (km^2) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> Central California </td>\n   <td style=\"text-align:center;\"> CA-C </td>\n   <td style=\"text-align:center;\"> 202738329147 </td>\n   <td style=\"text-align:center;\"> 3 </td>\n   <td style=\"text-align:center;\"> 202738.33 </td>\n   <td style=\"text-align:center;\"> 4940.0422 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Southern California </td>\n   <td style=\"text-align:center;\"> CA-S </td>\n   <td style=\"text-align:center;\"> 206860777840 </td>\n   <td style=\"text-align:center;\"> 4 </td>\n   <td style=\"text-align:center;\"> 206860.78 </td>\n   <td style=\"text-align:center;\"> 4221.3919 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Washington </td>\n   <td style=\"text-align:center;\"> WA </td>\n   <td style=\"text-align:center;\"> 66898309678 </td>\n   <td style=\"text-align:center;\"> 5 </td>\n   <td style=\"text-align:center;\"> 66898.31 </td>\n   <td style=\"text-align:center;\"> 3313.1592 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Oregon </td>\n   <td style=\"text-align:center;\"> OR </td>\n   <td style=\"text-align:center;\"> 179994061293 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 179994.06 </td>\n   <td style=\"text-align:center;\"> 1578.9688 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Northern California </td>\n   <td style=\"text-align:center;\"> CA-N </td>\n   <td style=\"text-align:center;\"> 164378809215 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 164378.81 </td>\n   <td style=\"text-align:center;\"> 454.2957 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Map Oyster Aquaculture Suitability\n\nOysters require relatively warm sea surface temperatures and moderate depths, making their potential habitat strongly influenced by latitudinal temperature gradients along the West Coast. The map below visualizes how these environmental constraints translate into regional differences in oyster aquaculture suitability across EEZs, highlighting areas where conditions are most favorable for oyster growth and infrastructure deployment.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Extract paleteer colors\nteal_palette <- as.character(paletteer_d(\"ggsci::teal_material\"))\neez_map <- eez_oyster_join %>% \n  filter(!is.na(suitable_area_km2)) \n\n# Map suitable area by EEZ\ntm_tiles(\"Esri.OceanBasemap\") +\ntm_shape(eez_map) +\n  tm_polygons(\n    col = \"suitable_area_km2\",\n    palette = colorRampPalette(teal_palette)(5),\n    title = \"Suitable Area (km^2)\") +\n  tm_layout(main.title = \"Oyster Aquaculture Suitability by EEZ\",\n            main.title.size = 1,\n            frame = FALSE,\n            legend.outside = TRUE,\n            legend.outside.position = \"right\",\n            outer.margins = c(0, 0, 0, 0),\n            inner.margins = c(0, 0, 0, 0.02)) +\n  tm_compass(position = c(\"right\", \"top\")) +\n  tm_scalebar(breaks = c(0, 100, 200, 300),\n              position = c(\"left\", \"bottom\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/oyster-result-1.png){width=672}\n:::\n:::\n\n\n## Reflection - Oyster Aquaculture Suitability\n\nThe oyster aquaculture suitability analysis demonstrates how combining raster-based environmental data with vector-based EEZ boundaries reveals spatial patterns relevant to marine resource planning. By averaging five years of SST data and resampling bathymetry, this analysis identifies regions where environmental conditions align with oyster growth requirements. Warmer southern EEZs exhibit substantially larger suitable areas than northern regions, highlighting how temperature and depth jointly constrain oyster aquaculture potential along the West Coast.\n\n## Apply Workflow Function\n\nTo show generalizability, the suitability workflow is applied to another species with different environmental thresholds.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# General Function to calculate aquaculture suitability\n\ncompute_suitability <- function(sst_min, sst_max,\n                                depth_min, depth_max,\n                                species_name) {\n  \n# 1. Reclassify SST\nsst_suitable <- lapp(sst_mean_celsius,\n                     fun = function(x) \n                       ifelse(x >= sst_min & x <= sst_max, 1, 0))\n\n# 2. Reclassify Depth\ndepth_suitable <- lapp(depth_resample,\n                       fun = function(x) \n                         ifelse(x >= depth_min & x <= depth_max, 1, 0))\n\n# 3. Combine Suitability\nsuitable_cells <- sst_suitable * depth_suitable\n\n# 4. Crop and Mask to EEZ\nsuitable_crop <- crop(suitable_cells, eez_vector)\nsuitable_eez <- mask(suitable_crop, eez_vector)\n\n# 5. Convert Suitability to Area in km^2\ncell_area <- cellSize(suitable_eez, unit = \"km\")\nsuitable_area <- suitable_eez * cell_area\nnames(suitable_area) <- \"suitable_area_km2\"\n\n# 6. Rasterize EEZ and Compute Zonal Area\neez_id_raster <- rasterize(eez_vector, suitable_area, field = \"eez_id\")\n\nzone_df <- zonal(suitable_area, eez_id_raster,\n                 fun = \"sum\", na.rm = TRUE) %>% \n  as.data.frame()\n\n# 7. Join results\neez_join <- eez %>% \n  left_join(zone_df, by = \"eez_id\")\n\n# 8. Map\nteal_palette <- as.character(paletteer_d(\"ggsci::teal_material\"))\n\nmap <- tm_tiles(\"Esri.OceanBasemap\") +\n  tm_shape(eez_join) +\n    tm_polygons(col = \"suitable_area_km2\",\n                palette = colorRampPalette(teal_palette)(20),\n                title = \"Suitable Area (km²)\") +\n    tm_layout(main.title = paste(\"Aquaculture Suitability for\",\n                                 species_name),\n              main.title.size = 1.0,\n              legend.outside = TRUE,\n              frame = FALSE) +\n    tm_compass(position = c(\"right\", \"top\")) +\n    tm_scalebar(breaks = c(0, 100, 200, 300),\n                position = c(\"left\", \"bottom\"))\nreturn(map)}\n```\n:::\n\n\n## Map Mussel Aquaculture Suitability\n\nMussels are adapted to cooler waters and shallower depths, leading to a spatial suitability pattern that differs markedly from that of oysters. The map below illustrates how these contrasting environmental preferences shift suitable habitat northward, revealing regions where mussel aquaculture may be more viable under existing temperature and depth conditions.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# SST 9 to 18 degrees Celsius, depth 0 to 20 meters\nmussle_map <- compute_suitability(\n  sst_min = 9,\n  sst_max = 18,\n  depth_min = -20,\n  depth_max = 0,\n  species_name = \"Mussels (A. californiensis)\")\n\nmussle_map\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/mussel-results-1.png){width=672}\n:::\n:::\n\n\n## Reflection - Mussel Aquaculture Suitability\n\nThe mussel suitability assessment shows different spatial patterns compare to oysters, emphasizing how species-specific environmental requirements could lead to different aquaculture potential across EEZs. Mussels favor cooler temperature and shallow depths and shows that more suitable northward than southern regions - sustainability is highest in Northern California and Washington.\n\n## Conclusion\n\nThis analysis demonstrates how we use spatial data science to evaluate the sustainability of aquaculture across large marine regions. By combining sea surface temperature data, bathymetry, raster reclassification, and Zonal statistics, we can identify locations that hit all the requirements for the environmental conditions specific to the aquaculture species. The results show that oysters prefer the warm southern waters, whereas mussels are better suited to the cooler northern regions of EEZs. The findings could improve productivity and reduce ecological risks.\n\n## Future Directions\n\nWhile this analysis highlights broad spatial patterns in aquaculture suitability, several limitations should be addressed in future work. Additional environmental variables, such as salinity, chlorophyll concentration, ocean currents, and wave exposure, play important roles in shellfish growth but are not included here. Socioeconomic and regulatory constraints also influence where aquaculture development is feasible, as not all environmentally suitable locations are accessible or permitted. Incorporating higher-resolution datasets and seasonal variability could further refine suitability estimates and support more detailed marine spatial planning.\n\n## Reference\n\nGEBCO Compilation Group. (2022). GEBCO_2022 Grid. Retrieved from <https://www.gebco.net>\n\nGentry, R. R., Froehlich, H. E., Grimm, D., Kareiva, P., Parke, M., Rust, M., Gaines, S. D., & Halpern, B. S. (2017). Mapping the global potential for marine aquaculture. Nature Ecology & Evolution, 1, 1317–1324.\n\nHall, S. J., Delaporte, A., Phillips, M. J., Beveridge, M., & O’Keefe, M. (2011). Blue Frontiers: Managing the Environmental Costs of Aquaculture. The WorldFish Center.\n\nMarine Regions. (2025). Exclusive Economic Zones data. Retrieved from <https://www.marineregions.org>\n\nNational Oceanic and Atmospheric Administration. (2008–2012). 5km Daily Global Satellite Sea Surface Temperature Anomaly v3.1. Retrieved from <https://www.ncei.noaa.gov>\n\nSeaLifeBase. (2025). *Adula californiensis* species summary. Retrieved from <https://www.sealifebase.ca/summary/Adula-californiensis.html>\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}